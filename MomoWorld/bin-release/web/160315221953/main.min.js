var Main=function(t){function e(){t.call(this),this.hadLoad=0,this.resList=["worldMap","map","hero","enemy","attack","other","num","item","ctrl"],this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onAddToStage=function(t){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(this.resList[0])},p.onResourceLoadComplete=function(t){this.hadLoad++,this.hadLoad==this.resList.length?(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),GameData.loadData(),GameData.reset(),this.stage.addChild(new World),UIManage.getInstance().showWelcome()):RES.loadGroup(this.resList[this.hadLoad])},p.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},p.onResourceProgress=function(t){},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var P2Tool=function(){function t(){}var e=(__define,t);return p=e.prototype,t.initSpace=function(t,e){this.factor=t,this.worldShape=e},t.clearWorld=function(t){if(null!=t){for(var e=0;e<t.bodies.length;e++)t.removeBody(t.bodies[0]);t.clear()}},t.createBox=function(e,i,a,o,n,s,h,l){var r=new p2.Body({mass:1,position:t.getP2Pos(a,o)}),d=new p2.Box({width:t.getP2Num(n),height:t.getP2Num(s)});if(""!=h){var p=Tool.addBitmap(e,h,a,o,n,s,!1);p.anchorOffsetX=p.width/2,p.anchorOffsetY=p.height/2,r.displays=[p]}return r.updateMassProperties(),r.addShape(d),l&&(d.material=new p2.Material),i.addBody(r),t.syncDisplay(r),r},t.createCircle=function(e,i,a,o,n,s,h){var l=new p2.Body({mass:1,position:t.getP2Pos(a,o)}),r=new p2.Circle({radius:t.getP2Num(n)});if(""!=s){var d=Tool.addBitmap(e,s,a,o,2*n,2*n,!1);d.anchorOffsetX=d.width/2,d.anchorOffsetY=d.height/2,l.displays=[d]}return l.addShape(r),h&&(r.material=new p2.Material),i.addBody(l),t.syncDisplay(l),l},t.createPlane=function(e,i,a,o){var n=new p2.Body,s=new p2.Plane;return n.addShape(s),n.type=p2.Body.STATIC,n.position[0]=t.getP2Num(i),n.position[1]=t.getP2Num(a),n.angle=Tool.getRadian(o),console.log("angle   "+Tool.getRadian(o)),e.addBody(n),n},t.setAngle=function(e,i){var a=3.14*(0-i)/180;1==e.fixedRotation?(e.fixedRotation=!1,e.angle=a,e.fixedRotation=!0):e.angle=a,t.syncDisplay(e)},t.syncDisplay=function(e){if(null!=e.displays){var i=e.displays[0],a=t.getEgretPos(e);i.x=a[0],i.y=a[1],i.rotation=360-180*e.angle/Math.PI}},t.getEgretNum=function(t){return t*this.factor},t.getP2Num=function(t){return t/this.factor},t.getP2Y=function(t){return(this.worldShape.height-t)/this.factor},t.getEgretY=function(t){return this.worldShape.height-t*this.factor},t.getP2Pos=function(t,e){var i=[t/this.factor,(this.worldShape.height-e)/this.factor];return i},t.getEgretPos=function(t){var e=t.position[0],i=t.position[1];return[e*this.factor,this.worldShape.height-i*this.factor]},t.getDistance=function(e,i){return Math.sqrt(Math.pow(t.getEgretNum(e.position[0])-t.getEgretNum(i.position[0]),2)+Math.pow(t.getEgretNum(e.position[1])-t.getEgretNum(i.position[1]),2))},t}();egret.registerClass(P2Tool,"P2Tool");var Tool=function(){function t(){}var e=(__define,t);return p=e.prototype,t.logObj=function(t){console.log("---------------");for(var e in t)console.log("p   "+e+":"+t[e])},t.addDisplayContainer=function(t,e,i,a,o,n,s){void 0===n&&(n=!1),void 0===s&&(s=!1);var h=new egret.DisplayObjectContainer;return t.addChild(h),h.x=e,h.y=i,h.width=a,h.height=o,n&&(h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2),s&&(h.scaleX=0,h.scaleY=0),h},t.clearItem=function(t){return null!=t&&null!=t.parent&&t.parent.removeChild(t),egret.Tween.removeTweens(t),null},t.logPosition=function(t){console.log("localX  "+t.localX+"  localY   "+t.localY+"     stageX "+t.stageX+"  stageY   "+t.stageY)},t.deepCopy=function(e){var i={};for(var a in e)i[a]="object"==typeof e[a]?t.deepCopy(e[a]):e[a];return i},t.addMoveClip=function(t,e,i,a,o,n,s,h){void 0===a&&(a=0),void 0===o&&(o=0),void 0===n&&(n=1),void 0===s&&(s=-1),void 0===h&&(h=!1);var l=RES.getRes(e+"_json"),r=RES.getRes(e+"_png"),d=new egret.MovieClipDataFactory(l,r),p=new egret.MovieClip(d.generateMovieClipData(i));return p.scaleX=n,p.scaleY=n,p.x=a,p.y=o,t.addChild(p),h&&(p.anchorOffsetX=p.measuredWidth/2,p.anchorOffsetY=p.measuredHeight/2),p.play(s),p},t.getDistance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.getRadian=function(t){return Math.PI*t/180},t.getAngle=function(t){return 180*t/Math.PI},t.clearTimeout=function(){for(var t=setTimeout(function(){},1),e=t-100>0?t-100:0,i=e;t>=i;i++)clearTimeout(i);console.log("clearTimer")},t.clearInterval=function(){for(var t=setInterval(function(){},1),e=t-100>0?t-100:0,i=e;t>=i;i++)clearInterval(i);console.log("clearInterval")},t.addShowScaleEffect=function(t){t.visible=!0,t.scaleX=.3,t.scaleY=.3,egret.Tween.get(t).to({scaleX:1,scaleY:1},1e3,egret.Ease.elasticOut)},t.addTouchScaleEffect=function(t,e,i){t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){egret.Tween.get(t).to({scaleX:.8,scaleY:.8},50)},e),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){egret.Tween.get(t).to({scaleX:1,scaleY:1},50).call(i,e)},e),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){egret.Tween.get(t).to({scaleX:1,scaleY:1},50).call(i,e)},e)},t.addBitmap=function(t,e,i,a,o,n,s,h){void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===h&&(h=!1);var l=new egret.Bitmap;return l.texture=RES.getRes(e),0!=o&&(l.width=Math.floor(o*GameData.scaleSmall),l.height=Math.floor(n*GameData.scaleSmall)),l.x=Math.floor(i*GameData.scaleSmall),l.y=Math.floor(a*GameData.scaleSmall),t.addChild(l),s&&(l.touchEnabled=!0,l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchStart,t),l.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.onTouchEnd,t),l.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),l.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemove,t)),h&&(l.anchorOffsetX=l.width/2,l.anchorOffsetY=l.height/2),l},t.addBitmapText=function(t,e,i,a,o,n){var s=new egret.BitmapText;return s.font=RES.getRes(e),0!=o&&(s.scaleX=o*GameData.scaleSmall,s.scaleY=o*GameData.scaleSmall),s.x=Math.floor(i*GameData.scaleSmall),s.y=Math.floor(a*GameData.scaleSmall),s.text=n,t.addChild(s),s},t.addTextField=function(t,e,i,a,o,n,s,h){var l=new egret.TextField;return l.fontFamily="Microsoft YaHei",l.x=Math.floor(e*GameData.scaleSmall),l.y=Math.floor(i*GameData.scaleSmall),0!=a&&(l.width=Math.floor(a*GameData.scaleSmall),l.height=Math.floor(o*GameData.scaleSmall)),l.textAlign=egret.HorizontalAlign.CENTER,l.textColor=s,l.bold=!0,l.size=Math.floor(n*GameData.scaleSmall),l.text=h+"",t.addChild(l),l},t.setLocal=function(t,e){localStorage.setItem(t,e)},t.getLocal=function(t){var e=localStorage.getItem(t);return e},t.checkLocal=function(t){var e=localStorage.getItem(t);return null==e||""==e?!1:!0},t.setZero=function(t,e){var i="";if(t.toString().length>e+1){for(var a=0;e>a;a++)i+="9";return i}for(var a=t.toString().length;e>a;a++)i+="0";return i+t.toString()},t.removeOne=function(t,e){if(e>=0&&e<t.length){for(var i=e;i<t.length;i++)t[i]=t[i+1];t.length=t.length-1}},t}();egret.registerClass(Tool,"Tool");var UIManage=function(){function t(){if(null!=t.instance)throw new Error("UIManage had been Instanced");t.instance=this,this.registerAndroidEvent(World.instance)}var e=(__define,t);return p=e.prototype,t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},p.clear=function(e){this.registerAndroidEvent(World.instance),null!=Hero.instance&&(Hero.instance=null),World.instance.removeChild(t.target),CtrlScene.getInstance().removeAll(),World.P2World&&P2Tool.clearWorld(World.P2World),t.target=null,e=null},p.showWelcome=function(){console.log("showWelcome"),null!=this.welcomeScene&&(this.welcomeScene=null),this.welcomeScene=new WelcomeScene,this.registerAndroidEvent(this.welcomeScene),t.target=this.welcomeScene,CtrlScene.getInstance().showCtrl("welcome"),World.instance.addChildAt(t.target,0)},p.hideWelcome=function(){null!=this.welcomeScene?(console.log("hideWelcome"),this.clear(this.welcomeScene)):console.log("welcomeScene   had   not  instance")},p.showMap=function(){console.log("showMap"),null!=this.mapScene&&(this.mapScene=null),this.mapScene=new MapScene,t.target=this.mapScene,World.instance.addChildAt(t.target,0)},p.hideMap=function(){null!=this.mapScene?(console.log("hideMap"),this.clear(this.mapScene)):console.log("mapScene   had   not  instance")},p.showWarScene=function(){console.log("showWar"),null!=this.warScene&&(this.warScene=null),this.warScene=new WarScene,this.registerAndroidEvent(this.warScene),t.target=this.warScene,World.instance.addChildAt(t.target,0),CtrlScene.getInstance().showTop(),CtrlScene.getInstance().showCtrl()},p.hideWarScene=function(){null!=this.warScene?(console.log("hideWarScene"),this.clear(this.warScene)):console.log("warScene   had   not  instance")},p.registerAndroidEvent=function(t){window.gameObj=t,window.keyConfirm=t.control,window.keyMenu=t.control,window.keyJump=t.control,window.keySkill1=t.control,window.keySkill2=t.control,window.keyAttack=t.control,window.keyLeft=t.control,window.keyUp=t.control,window.keyRight=t.control,window.keyDown=t.control},t}();egret.registerClass(UIManage,"UIManage");var World=function(t){function e(){if(t.call(this),this.world_speed=.05,null!=e.instance)throw new Error("World had been Instanced");e.instance=this,this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){CtrlScene.getInstance(),this.createWorldSystem(),e.P2World=this.world,this.addEventListener(egret.Event.ENTER_FRAME,this.flash,this)},p.createWorldSystem=function(){this.world=new p2.World,this.world.sleepMode=p2.World.BODY_SLEEPING,this.world.setGlobalStiffness(1e5),this.world.defaultContactMaterial.restitution=.1,this.world.gravity[0]=0,this.world.gravity[1]=-6},p.flash=function(){CtrlScene.getInstance().syncFun(),this.world.step(this.world_speed),null!=UIManage.target&&"function"==typeof UIManage.target.syncDisplay&&UIManage.target.syncDisplay()},p.control=function(t){console.log("this is World control")},e}(egret.DisplayObjectContainer);egret.registerClass(World,"World");var getBoss=function(t){return window["boss"+t]},boss1={name:"enemy1",blood:500,exp:50,dropItem:[{type:"Equipment",id:100,change:.5}],stand:{offsetX:-15,offsetY:-25,halfWidth:65,halfHeight:100,powerBase:5,powerSpace:2,baseTime:200,spaceTime:200},walk:{offsetX:-15,offsetY:-25,speed:1,baseTime:200,spaceTime:200},attack:{offsetX:-85,offsetY:-50,powerBase:10,powerSpace:5,range:200},hit:{offsetX:-15,offsetY:-35,CD:50},die:{offsetX:-30,offsetY:-35,items:["thing1"]}},getBullet=function(t){return window["bullet"+t]},bullet1={name:"bullet1",range:350},bullet2={id:2,name:"bullet2",range:500,offsetX:30,offsetY:10,scale:.8},daily={date:"0001",items:[{icon:"daily_icon1_png",detail:"任务1",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"daily_icon2_png",detail:"任务2",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"daily_icon3_png",detail:"任务3",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"daily_icon4_png",detail:"任务4",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"daily_icon5_png",detail:"任务5",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"}]},achievement={date:"0001",items:[{icon:"achievement_icon1_png",detail:"成就1",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"achievement_icon2_png",detail:"成就2",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"achievement_icon3_png",detail:"成就3",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"achievement_icon4_png",detail:"成就4",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"},{icon:"achievement_icon5_png",detail:"成就5",gift:"奖励",type:"奖励类型",num:30,ques:5,state:"go"}]},ability={skill1:[{icon:"ability_skill1_1_png",skill:"技能1",name:"单攻技能1",intruction:"单攻技能1简介"},{icon:"ability_skill1_2_png",skill:"技能2",name:"单攻技能2",intruction:"单攻技能2简介"},{icon:"ability_skill1_3_png",skill:"技能3",name:"单攻技能3",intruction:"单攻技能3简介"},{icon:"ability_skill1_4_png",skill:"技能4",name:"单攻技能4",intruction:"单攻技能4简介"},{icon:"ability_skill1_5_png",skill:"技能5",name:"单攻技能5",intruction:"单攻技能5简介"}],skill2:[{icon:"ability_skill2_1_png",skill:"技能1",name:"群攻技能1",intruction:"群攻技能1简介"},{icon:"ability_skill2_2_png",skill:"技能2",name:"群攻技能2",intruction:"群攻技能2简介"},{icon:"ability_skill2_3_png",skill:"技能3",name:"群攻技能3",intruction:"群攻技能3简介"},{icon:"ability_skill2_4_png",skill:"技能4",name:"群攻技能4",intruction:"群攻技能4简介"},{icon:"ability_skill2_5_png",skill:"技能5",name:"群攻技能5",intruction:"群攻技能5简介"}],data:[{icon:"ability_boold",type:"血量",name:"血量",intruction:"血量简介"},{icon:"ability_power",type:"法力",name:"法力",intruction:"法力简介"},{icon:"ability_attack",type:"普攻",name:"普攻",intruction:"普攻简介"},{icon:"ability_defense1_",type:"物抗",name:"物抗",intruction:"物抗简介"},{icon:"ability_defense2_",type:"法抗",name:"法抗",intruction:"法抗简介"}]},drupShop=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],weaponShop=[100,101,102,103,104,105,106,107,108,109,110,111,200,201,202,203,204,205,206,207,208,209,210,211,300,301,302,303,304,305,306,307,308,309,310,311,400,401,402,403,404,405,406,407,408,409,410,411,500,501,502,503,504,505,506,507,508,509,510,511,600,601,602,603,604,605,606,607,608,609,610,611,700,701,702,703,704,705,706,707,708,709,710,711,800,801,802,803,804,805,806,807,808,809,810,811,900,901,902,903,904,905,906,907,908,909,910,911,1e3,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011],heroState={ring:[{x:44,y:55,id:-1},{x:44,y:110,id:-1},{x:44,y:163,id:-1},{x:44,y:218,id:-1},{x:44,y:273,id:-1},{x:44,y:330,id:-1}],hat:{x:151,y:55,id:-1},clothes:{x:151,y:218,id:-1},trouser:{x:151,y:273,id:-1},shoe:{x:151,y:330,id:-1},weapon:{x:97,y:218,id:-1},shield:{x:257,y:218,id:-1},earring:{x:205,y:163,id:-1},cloak:{x:257,y:273,id:-1},glove:{x:205,y:273,id:-1}},getDrupNum=function(t){for(var e=GameData.bag_Drup.length-1;e>-1;e--){var i=Math.floor(GameData.bag_Drup[e]);if(i==t)return Math.floor(100*(GameData.bag_Drup[e]-i))}return 0},setDrupNum=function(t,e){for(var i=GameData.bag_Drup.length-1;i>-1;i--){var a=Math.floor(GameData.bag_Drup[i]);if(a==t)return GameData.bag_Drup[i]+=.01*e,Math.floor(100*(GameData.bag_Drup[i]-a))}},getDrup=function(t){return console.log("getDrup"),window["drupData"+t]},drupData0={res:"item_drup0_png",name:"劣质红色药水",type:"gold",cost:5,info:"恢复生命值10点",grade:1,func:"blood",funcNum:10},drupData1={res:"item_drup1_png",name:"劣质蓝色药水",type:"gold",cost:5,info:"劣质恢复魔法值10点",grade:1,func:"power",funcNum:10},drupData2={res:"item_drup2_png",name:"普通红色药水",type:"gold",cost:10,info:"恢复生命值20点",grade:1,func:"blood",funcNum:20},drupData3={res:"item_drup3_png",name:"普通蓝色药水",type:"gold",cost:10,info:"恢复魔法值20点",grade:1,func:"power",funcNum:20},drupData4={res:"item_drup4_png",name:"高级红色药水",type:"gold",cost:20,info:"恢复生命值50点",grade:1,func:"blood",funcNum:50},drupData5={res:"item_drup5_png",name:"高级蓝色药水",type:"gold",cost:20,info:"恢复魔法值50点",grade:1,func:"power",funcNum:50},drupData6={res:"item_drup6_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:2,func:"blood",funcNum:100},drupData7={res:"item_drup7_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:2,func:"power",funcNum:100},drupData8={res:"item_drup8_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData9={res:"item_drup9_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData10={res:"item_drup10_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData11={res:"item_drup11_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData12={res:"item_drup12_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData13={res:"item_drup13_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData14={res:"item_drup14_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData15={res:"item_drup15_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData16={res:"item_drup16_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData17={res:"item_drup17_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData18={res:"item_drup18_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData19={res:"item_drup19_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData20={res:"item_drup20_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData21={res:"item_drup21_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData22={res:"item_drup22_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData23={res:"item_drup23_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},drupData24={res:"item_drup24_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复生命值10点",grade:1,func:"blood",funcNum:100},drupData25={res:"item_drup25_png",name:"劣质红色药水",type:"gold",cost:25,info:"恢复魔法值10点",grade:1,func:"power",funcNum:100},getEnemy=function(t){return window["enemy"+t]},enemy1={name:"enemy1",blood:500,exp:50,dropItem:[{type:"Item",id:0,change:.5},{type:"Item",id:1,change:.5},{type:"Item",id:2,change:.5},{type:"Item",id:3,change:.5},{type:"Item",id:4,change:.5},{type:"Item",id:5,change:.5},{type:"Drup",id:0,change:.5}],stand:{offsetX:-15,offsetY:-25,halfWidth:65,halfHeight:100,powerBase:5,powerSpace:2,baseTime:200,spaceTime:200},walk:{offsetX:-15,offsetY:-25,speed:1,baseTime:200,spaceTime:200},attack:{offsetX:-85,offsetY:-50,powerBase:10,powerSpace:5,range:200},hit:{offsetX:-15,offsetY:-35,CD:50},die:{offsetX:-30,offsetY:-35}},getEquipment=function(t){return window["equipmentData"+t]},equipmentData0={res:"item_equipment0_png",name:"itme0",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData100={res:"item_equipment100_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData101={res:"item_equipment101_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData102={res:"item_equipment102_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData103={res:"item_equipment103_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData104={res:"item_equipment104_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData105={res:"item_equipment105_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData106={res:"item_equipment106_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData107={res:"item_equipment107_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData108={res:"item_equipment108_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData109={res:"item_equipment109_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData110={res:"item_equipment110_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData111={res:"item_equipment111_png",name:"披风",type:"gold",cost:300,info:"帅气的披风，增加物抗10点",grade:1,_type:"cloak"},equipmentData200={res:"item_equipment200_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData201={res:"item_equipment201_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData202={res:"item_equipment202_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData203={res:"item_equipment203_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData204={res:"item_equipment204_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData205={res:"item_equipment205_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData206={res:"item_equipment206_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData207={res:"item_equipment207_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData208={res:"item_equipment208_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData209={res:"item_equipment209_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData210={res:"item_equipment210_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData211={res:"item_equipment211_png",name:"上衣",type:"gold",cost:300,info:"结实的上衣，增加魔抗10点",grade:1,_type:"clothes"},equipmentData300={res:"item_equipment300_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData301={res:"item_equipment301_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData302={res:"item_equipment302_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData303={res:"item_equipment303_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData304={res:"item_equipment304_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData305={res:"item_equipment305_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData306={res:"item_equipment306_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData307={res:"item_equipment307_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData308={res:"item_equipment308_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData309={res:"item_equipment309_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData310={res:"item_equipment310_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData311={res:"item_equipment311_png",name:"漂亮的耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"earring"},equipmentData400={res:"item_equipment400_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData401={res:"item_equipment401_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData402={res:"item_equipment402_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData403={res:"item_equipment403_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData404={res:"item_equipment404_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData405={res:"item_equipment405_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData406={res:"item_equipment406_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData407={res:"item_equipment407_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData408={res:"item_equipment408_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData409={res:"item_equipment409_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData410={res:"item_equipment410_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData411={res:"item_equipment411_png",name:"手套",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"glove"},equipmentData500={res:"item_equipment500_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData501={res:"item_equipment501_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData502={res:"item_equipment502_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData503={res:"item_equipment503_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData504={res:"item_equipment504_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData505={res:"item_equipment505_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData506={res:"item_equipment506_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData507={res:"item_equipment507_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData508={res:"item_equipment508_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData509={res:"item_equipment509_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData510={res:"item_equipment510_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData511={res:"item_equipment511_png",name:"帽子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"hat"},equipmentData600={res:"item_equipment600_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData601={res:"item_equipment601_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData602={res:"item_equipment602_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData603={res:"item_equipment603_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData604={res:"item_equipment604_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData605={res:"item_equipment605_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData606={res:"item_equipment606_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData607={res:"item_equipment607_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData608={res:"item_equipment608_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData609={res:"item_equipment609_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData610={res:"item_equipment610_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData611={res:"item_equipment611_png",name:"耳环",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"ring"},equipmentData700={res:"item_equipment700_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData701={res:"item_equipment701_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData702={res:"item_equipment702_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData703={res:"item_equipment703_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData704={res:"item_equipment704_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData705={res:"item_equipment705_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData706={res:"item_equipment706_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData707={res:"item_equipment707_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData708={res:"item_equipment708_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData709={res:"item_equipment709_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData710={res:"item_equipment710_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData711={res:"item_equipment711_png",name:"盾牌",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shield"},equipmentData800={res:"item_equipment800_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData801={res:"item_equipment801_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData802={res:"item_equipment802_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData803={res:"item_equipment803_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData804={res:"item_equipment804_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData805={res:"item_equipment805_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData806={res:"item_equipment806_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData807={res:"item_equipment807_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData808={res:"item_equipment808_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData809={res:"item_equipment809_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData810={res:"item_equipment810_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData811={res:"item_equipment811_png",name:"鞋子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"shoe"},equipmentData900={res:"item_equipment900_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData901={res:"item_equipment901_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData902={res:"item_equipment902_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData903={res:"item_equipment903_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData904={res:"item_equipment904_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData905={res:"item_equipment905_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData906={res:"item_equipment906_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData907={res:"item_equipment907_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData908={res:"item_equipment908_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData909={res:"item_equipment909_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData910={res:"item_equipment910_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData911={res:"item_equipment911_png",name:"裤子",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"trouser"},equipmentData1000={res:"item_equipment1000_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1001={res:"item_equipment1001_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1002={res:"item_equipment1002_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1003={res:"item_equipment1003_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1004={res:"item_equipment1004_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1005={res:"item_equipment1005_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1006={res:"item_equipment1006_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1007={res:"item_equipment1007_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1008={res:"item_equipment1008_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1009={res:"item_equipment1009_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1010={res:"item_equipment1010_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},equipmentData1011={res:"item_equipment1011_png",name:"武器",type:"gold",cost:300,info:"增加法抗100点",grade:1,_type:"weapon"},GameData=function(){function t(){}var e=(__define,t);
return p=e.prototype,t.reset=function(){},t.loadData=function(){console.log("loadData"),Tool.checkLocal("MapState")&&(t.MapState=JSON.parse(Tool.getLocal("MapState"))),Tool.checkLocal("skill1State")&&(t.skill1State=JSON.parse(Tool.getLocal("skill1State"))),Tool.checkLocal("skill2State")&&(t.skill2State=JSON.parse(Tool.getLocal("skill2State"))),Tool.checkLocal("abilityState")&&(t.abilityState=JSON.parse(Tool.getLocal("abilityState"))),Tool.checkLocal("skillNum")&&(t.skillNum=JSON.parse(Tool.getLocal("skillNum"))),Tool.checkLocal("bodyNum")&&(t.bodyNum=JSON.parse(Tool.getLocal("bodyNum"))),Tool.checkLocal("skill1Index")&&(t.skill1Index=JSON.parse(Tool.getLocal("skill1Index"))),Tool.checkLocal("skill2Index")&&(t.skill2Index=JSON.parse(Tool.getLocal("skill2Index")))},t.saveData=function(){console.log("saveData"),Tool.setLocal("MapState",JSON.stringify(t.MapState)),Tool.setLocal("skill1State",JSON.stringify(t.skill1State)),Tool.setLocal("skill2State",JSON.stringify(t.skill2State)),Tool.setLocal("abilityState",JSON.stringify(t.abilityState)),Tool.setLocal("skillNum",JSON.stringify(t.skillNum)),Tool.setLocal("bodyNum",JSON.stringify(t.bodyNum)),Tool.setLocal("skill1Index",JSON.stringify(t.skill1Index)),Tool.setLocal("skill2Index",JSON.stringify(t.skill2Index)),Tool.setLocal("bag_Equipment",JSON.stringify(t.bag_Equipment)),Tool.setLocal("bag_Piece",JSON.stringify(t.bag_Piece)),Tool.setLocal("bag_Item",JSON.stringify(t.bag_Item)),Tool.setLocal("bag_Drup",JSON.stringify(t.bag_Drup)),Tool.setLocal("goldNum",t.goldNum),Tool.setLocal("diamondNum",t.diamondNum),Tool.setLocal("bag_BooldId",t.bag_BooldId),Tool.setLocal("bag_PowerId",t.bag_PowerId)},t.gameWidth=800,t.gameHeight=480,t.scaleSmall=1,t.bodyWidth=25,t.mapIndex=-1,t.difficulty=0,t.itemArray=[],t.enemyArray=[],t.bulletArray=[],t.goldNum=500,t.diamondNum=500,t.skillNum=50,t.bodyNum=50,t.heroIndex=1,t.skill1State=[1.25,.3,.3,.3,.3],t.skill2State=[1.25,.3,.3,.3,.3],t.abilityState=[.3,.3,.3,.3,.3],t.skill1Index=2,t.skill2Index=1,t.bag_Equipment=[101,201,303,405],t.bag_Piece=[],t.bag_Item=[.05,.05],t.bag_Drup=[.05,1.05],t.bag_BloodId=0,t.bag_PowerId=1,t.data_Equipment={cloak:100,clothes:200,earring:300,glove:400,hat:500,ring:[600,600,600,600,600,600],shield:700,shoe:800,trouser:900,weapon:1e3},t.MapState=[3,2,1,0,0,0,0,0,0,0],t}();egret.registerClass(GameData,"GameData");var getHero=function(t){return"1"==t?hero1:void 0},hero1={name:"hero1",blood:500,power:200,exp:155,expSpace:200,stand:{offsetX:-10,offsetY:-17.5},walk:{offsetX:5,offsetY:-22,moveSpeed:1.5},jump:{offsetX:10,offsetY:-17.5},attack:{offsetX:-12,offsetY:-17.5,powerBase:50,powerSpace:20,speed:10,CD:30},hit:{offsetX:-13,offsetY:-20,CD:50,hitMove:1},die:{offsetX:0,offsetY:-6},levelUp:{offsetX:0,offsetY:-80},skill0:{offsetX:-2,offsetY:-22.5,skillOffsetX:-12,skillOffsetY:-17.5,powerBase:50,powerSpace:20,cost:10,speed:20,CD:10,range:[{},{}]},skill1:{offsetX:-2,offsetY:-22.5,powerBase:50,powerSpace:20,cost:10,speed:15,CD:20},skill2:{offsetX:-2,offsetY:-22.5,powerBase:100,powerSpace:50,cost:20,speed:15,CD:30},skill6:{id:6,offsetX:-2,offsetY:-22.5,skillScale:.6,skillOffsetX:-120,skillOffsetY:-240,hitOffsetX:0,hitOffsetY:0,powerBase:100,powerSpace:50,cost:40,speed:15,CD:100,range:[{x:-300,space:600}]}},getItem=function(t){return window["itemData"+t]},itemData0={res:"item_item0_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData1={res:"item_item1_png",name:"item1",type:"gold",cost:25,info:"itme0",grade:1},itemData2={res:"item_item2_png",name:"item1",type:"gold",cost:25,info:"itme0",grade:1},itemData3={res:"item_item3_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData4={res:"item_item4_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData5={res:"item_item5_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData6={res:"item_item6_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData7={res:"item_item7_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData8={res:"item_item8_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData9={res:"item_item9_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData10={res:"item_item10_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData11={res:"item_item11_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},itemData12={res:"item_item12_png",name:"item0",type:"gold",cost:25,info:"itme0",grade:1},getMap=function(t){var e=window["mapData"+t];e.dropItem.length=[];for(var i=0;i<e.enemy.length;i++)for(var a=getEnemy(e.enemy[i].id),o=0;o<a.dropItem.length;o++)e.dropItem.push(window["get"+a.dropItem[o].type](a.dropItem[o].id));for(var i=0;i<e.boss.length;i++)for(var n=getBoss(e.boss[i].id),o=0;o<n.dropItem.length;o++)e.dropItem.push(window["get"+n.dropItem[o].type](n.dropItem[o].id));return e},mapData0={name:"圣  地",res:"map_shengdi_png",level:"01~05",enemyNum:10,dropItem:[],enemy:[{id:1,num:15}],boss:[{id:1,chance:.2}]},mapData1={name:"水底世界",res:"map_shengdi_png",level:"05~10",enemyNum:10,dropItem:[],enemy:[],boss:[{id:1,chance:.2}]},getPiece=function(t){return window["pieceData"+t]},pieceData0={res:"item_piece0_png",name:"piece0",type:"gold",cost:25,info:"piece0",grade:1},Bullet=function(){function t(t,e,i,a,o,n,s){this._name="1",this.speed=0,this.originX=0,this.toward=1,this.powerBase=0,this.powerSpace=0,this.isOver=!1,this._name=t,this.speed=e,this.toward=i,this.powerBase=n,this.powerSpace=s,this.data=getBullet(this._name),this.show=Tool.addBitmap(UIManage.target.item,this.data.name+"_png",a,o,0,0,!1),this.show.anchorOffsetX=this.show.width/2,this.show.anchorOffsetY=this.show.height/2,this.show.scaleX=this.toward,this.originX=a}var e=(__define,t);return p=e.prototype,p.syncFun=function(){this.show.x-=this.speed*this.toward;var t=Math.abs(this.show.x-this.originX);if(t>this.data.range-50&&(this.show.alpha=(this.data.range-t)/50),t>this.data.range)return void(this.isOver=!0);for(var e=0;e<GameData.enemyArray.length;e++){var i=GameData.enemyArray[e];if(!i.isDie){var a=Math.abs(this.show.x-P2Tool.getEgretNum(i.body.position[0]));if(a<i.data.stand.halfWidth){this.isOver=!0,i.action("hit",this.data);var o=Math.floor(Math.random()*this.powerSpace),n=this.powerBase+o;return o>.8*this.powerSpace?new Num("num3",P2Tool.getEgretNum(i.body.position[0]),P2Tool.getEgretY(i.body.position[1])-50,n):new Num("num2",P2Tool.getEgretNum(i.body.position[0]),P2Tool.getEgretY(i.body.position[1])-50,n),void i.setData("blood",-n)}}}},t}();egret.registerClass(Bullet,"Bullet");var Enemy=function(t){function e(e,i){t.call(this),this.offsetX=0,this.offsetY=0,this.blood=1,this.toward=1,this.moveTime=0,this.standTime=0,this.hitCD=0,this.actionType="",this.mcType="",this._name="empty",this.isDie=!1,this.isSkill=!1,this.isAngry=!1,this.isMissing=!1,this.init(e,i)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(t,e){this._name=t,this.data=getEnemy(this._name),this.blood=this.data.blood,this.show=Tool.addMoveClip(this,this.data.name,"stand",0,0,1,-1,!0),this.body=P2Tool.createBox(this,World.P2World,e,50,GameData.bodyWidth,GameData.bodyWidth,"",!1),this.body.shapes[0].collisionGroup=2,this.body.shapes[0].collisionMask=1,this.setChildIndex(this.show,99),this.action("stand")},p.syncFun=function(){if(!this.isDie)if(P2Tool.syncDisplay(this.body),this.show.x=P2Tool.getEgretNum(this.body.position[0])+this.offsetX*this.toward,this.show.y=P2Tool.getEgretY(this.body.position[1])+this.offsetY,"walk"==this.actionType){if(this.isAngry){var t=function(){Hero.getInstance().body.position[0]>this.body.position[0]+P2Tool.getP2Num(50)?this.toward=-1:Hero.getInstance().body.position[0]<this.body.position[0]-P2Tool.getP2Num(50)&&(this.toward=1),this.show.scaleX=this.toward,this.body.position[0]-=P2Tool.getP2Num(this.data.walk.speed*this.toward)}.bind(this);if(null==this.data.attack)t();else{var e=Math.abs(P2Tool.getEgretNum(this.body.position[0])-P2Tool.getEgretNum(Hero.getInstance().body.position[0]));e<this.data.attack.range?this.action("attack"):t()}return}this.moveTime--;var i=this.show.measuredWidth/2-this.offsetX*this.toward,a=UIManage.target.tureWidth;this.show.x>i&&this.show.x<a-i&&(this.body.position[0]-=P2Tool.getP2Num(this.data.walk.speed*this.toward)),this.moveTime<0&&(this.body.velocity[0]=0,this.action("stand"))}else"stand"==this.actionType?(this.standTime--,0==this.standTime&&this.action("walk")):"hit"==this.actionType&&(this.hitCD--,0==this.hitCD&&this.action("walk"))},p.checkHit=function(){for(var t=0;t<GameData.bulletArray.length;t++){var e=GameData.bulletArray[t];if(e.isOver)return;var i=Math.abs(e.show.x-P2Tool.getEgretNum(this.body.position[0]));if(i<this.data.stand.halfWidth){e.isOver=!0,this.action("hit"),this.isAngry=!0;var a=Math.floor(Math.random()*Hero.getInstance().data.attack.powerSpace),o=Hero.getInstance().data.attack.powerBase+a;return this.blood-=o,void(a>.8*Hero.getInstance().data.attack.powerSpace?new Num("num3",P2Tool.getEgretNum(this.body.position[0]),P2Tool.getEgretY(this.body.position[1])-50,o):new Num("num2",P2Tool.getEgretNum(this.body.position[0]),P2Tool.getEgretY(this.body.position[1])-50,o))}}},p.action=function(t,e){void 0===e&&(e=null),this.actionType=t,"walk"==t?(this.toward=1,Math.random()<.5&&(this.toward=-1),this.moveTime=Math.floor(Math.random()*this.data.walk.spaceTime)+this.data.walk.baseTime,this.setMoveClip("walk")):"stand"==t?(this.setMoveClip("stand"),this.standTime=Math.floor(Math.random()*this.data.stand.spaceTime)+this.data.stand.baseTime):"hit"!=t||this.isMissing?"attack"==t?(this.isMissing=!0,this.setMoveClip("attack")):"die"==t&&(this.isDie=!0,this.setMoveClip("die"),Hero.getInstance().setData("exp",this.data.exp)):(this.isAngry=!0,this.isSkill=!1,this.hitCD=this.data.hit.CD,this.setMoveClip("hit"),null!=e&&null==this.hitEffect&&(this.hitEffect=Tool.addMoveClip(this,"attack_hit"+e.id,"attack_hit"+e.id,P2Tool.getEgretNum(this.body.position[0])-e.offsetX,this.show.y-e.offsetY,e.scale,1,!0),this.hitEffect.addEventListener(egret.Event.COMPLETE,this.mcOver.bind(this,"hitEffect"),this)))},p.mcOver=function(t){if(void 0===t&&(t=null),"hitEffect"==t)return this.removeChild(this.hitEffect),this.hitEffect.removeEventListener(egret.Event.COMPLETE,this.mcOver.bind(this,"hitEffect"),this),void(this.hitEffect=null);if("attack"==this.mcType){this.isMissing=!1;var e=(P2Tool.getEgretNum(this.body.position[0])-P2Tool.getEgretNum(Hero.getInstance().body.position[0]))*this.toward;(e>this.data.attack.range||0>e)&&(this.isSkill=!1,this.action("walk"))}else if("die"==this.mcType){this.show=null,this.parent.removeChild(this),World.P2World.removeBody(this.body);var i=Math.floor(Math.random()*this.data.dropItem.length);GameData.itemArray.push(new Item(this.data.dropItem[i].id,P2Tool.getEgretNum(this.body.position[0]),P2Tool.getEgretY(this.body.position[1])))}},p.setMoveClip=function(t){var e=this;this.mcType=t,this.offsetX=this.data[t].offsetX,this.offsetY=this.data[t].offsetY,null!=this.show&&null!=this.show.parent&&this.removeChild(this.show),this.show=Tool.addMoveClip(this,this.data.name,t,0,0,1,-1,!0),this.show.x=P2Tool.getEgretNum(this.body.position[0])+this.offsetX*this.toward,this.show.y=P2Tool.getEgretY(this.body.position[1])+this.offsetY,this.show.scaleX=this.toward,this.show.addEventListener(egret.Event.LOOP_COMPLETE,this.mcOver,this),"attack"==this.mcType&&this.show.addEventListener(egret.MovieClipEvent.FRAME_LABEL,function(t){"@attackTure"==t.frameLabel&&(e.isSkill=!0)},this)},p.setData=function(t,e){return"blood"==t?(this.blood+=e,this.blood<0&&!this.isDie&&this.action("die"),this.blood):void 0},e}(egret.DisplayObjectContainer);egret.registerClass(Enemy,"Enemy");var Hero=function(t){function e(i){if(t.call(this),this.bloodMax=1,this.blood=1,this.powerMax=1,this.power=1,this.expMax=1,this.exp=1,this.level=1,this.offsetX=0,this.offsetY=0,this.toward=1,this.attackCD=0,this.hitCD=0,this.moveSpeed=8,this.jumpPower=5,this.skillIndex=-1,this._name="1",this.jumpState="",this.actionType="",this.mcType="",this.isDie=!1,this.isLevelUp=!1,this.isWalking=!1,this.isHitting=!1,this.isMissing=!1,this.isSkilling=!1,this.isAttack=!1,null!=e.instance)throw new Error("Hero had been Instanced");e.instance=this,this.init(i)}__extends(e,t);var i=(__define,e);return p=i.prototype,e.getInstance=function(){return null==e.instance&&(e.instance=new e(GameData.heroIndex)),e.instance},p.init=function(t){this._name=t,this.data=getHero(this._name),this.bloodMax=this.data.blood,this.blood=this.data.blood,this.powerMax=this.data.power,this.power=this.data.power,this.expMax=this.data.exp,this.exp=0,this.show=Tool.addMoveClip(this,this.data.name,"stand",0,0,1,-1,!0),this.body=P2Tool.createBox(this,World.P2World,200,50,GameData.bodyWidth,GameData.bodyWidth,"",!1),this.body.shapes[0].collisionGroup=2,this.body.shapes[0].collisionMask=1,this.action("stand")},p.syncFun=function(){this.blood<0&&!this.isDie&&this.action("die"),this.checkHit(),P2Tool.syncDisplay(this.body);var t=P2Tool.getEgretNum(this.body.position[0]),e=P2Tool.getEgretY(this.body.position[1]);this.show.x=t+this.offsetX*this.toward,this.show.y=e+this.offsetY,this.body.position[0]<P2Tool.getP2Num(25)&&(this.body.position[0]=P2Tool.getP2Num(25)),this.body.position[0]>P2Tool.getP2Num(UIManage.target.tureWidth-25)&&(this.body.position[0]=P2Tool.getP2Num(UIManage.target.tureWidth-25)),1==this.isWalking&&(this.body.position[0]-=P2Tool.getP2Num(this.moveSpeed)*this.toward),this.isLevelUp&&(this.show2.y=P2Tool.getEgretY(this.body.position[1])+this.data.levelUp.offsetY,this.show2.x=P2Tool.getEgretNum(this.body.position[0])+this.data.levelUp.offsetX);var i=UIManage.target;if(t>GameData.gameWidth/2&&t<i.measuredWidth-GameData.gameWidth/2&&(i.x=GameData.gameWidth/2-t),this.body.velocity[1]<0&&"up"==this.jumpState&&(this.jumpState="down"),this.body.velocity[1]>0&&"down"==this.jumpState&&(this.isWalking?this.setMoveClip("walk"):this.action("stand"),this.jumpState="empty"),this.attackCD>0&&this.attackCD--,this.isMissing&&(this.hitCD--,this.hitCD<0&&1==this.isHitting&&(this.isHitting=!1,this.action("stand")),this.hitCD<-80&&(this.isMissing=!1)),this.isAttack&&this.attackCD<1&&(this.attackCD=this.data.attack.CD,GameData.bulletArray.push(new Bullet("1",this.data.attack.speed,this.toward,P2Tool.getEgretNum(this.body.position[0])-GameData.bodyWidth*this.toward,P2Tool.getEgretY(this.body.position[1])-GameData.bodyWidth/2,this.data.attack.powerBase,this.data.attack.powerSpace))),this.isSkilling&&this.attackCD<1){console.log("this.skill    "+this.skillIndex);var a=this.data["skill"+this.skillIndex];if(this.setData("power",-a.cost)>-1)switch(this.attackCD=a.CD,this.skillIndex){case 0:GameData.bulletArray.push(new Bullet("1",a.speed,this.toward,P2Tool.getEgretNum(this.body.position[0])-GameData.bodyWidth*this.toward,P2Tool.getEgretY(this.body.position[1])-GameData.bodyWidth/2,a.powerBase,a.powerSpace));break;case 1:GameData.bulletArray.push(new Bullet("1",a.speed,this.toward,P2Tool.getEgretNum(this.body.position[0])-GameData.bodyWidth*this.toward,P2Tool.getEgretY(this.body.position[1])-GameData.bodyWidth/2,a.powerBase,a.powerSpace)),window.setTimeout(function(){GameData.bulletArray.push(new Bullet("1",a.speed,this.toward,P2Tool.getEgretNum(this.body.position[0])-GameData.bodyWidth*this.toward,P2Tool.getEgretY(this.body.position[1])-GameData.bodyWidth/2,a.powerBase,a.powerSpace))}.bind(this),100);break;case 2:GameData.bulletArray.push(new Bullet("2",a.speed,this.toward,P2Tool.getEgretNum(this.body.position[0])-GameData.bodyWidth*this.toward,P2Tool.getEgretY(this.body.position[1])-GameData.bodyWidth/2,a.powerBase,a.powerSpace));break;case 0:}}},p.checkHit=function(){for(var t=0;t<GameData.itemArray.length;t++){var e=GameData.itemArray[t];Math.abs(P2Tool.getEgretNum(this.body.position[0])-e.show.x)<e.range&&e.pickUp()}if(!this.isMissing&&!this.isDie)for(var t=0;t<GameData.enemyArray.length;t++){var i=GameData.enemyArray[t];if(i.isDie)return;if(0==i.isSkill){var a=Math.abs(i.show.x-P2Tool.getEgretNum(this.body.position[0]));if(a<i.data.stand.halfWidth){this.action("hit");var o=i.data.stand.powerBase+Math.floor(Math.random()*i.data.stand.powerSpace);return this.blood-=o,void new Num("num1",P2Tool.getEgretNum(this.body.position[0]),P2Tool.getEgretY(this.body.position[1])-50,o)}}else{var a=(P2Tool.getEgretNum(i.body.position[0])-P2Tool.getEgretNum(this.body.position[0]))*i.toward;if(a<i.data.attack.range&&a>0){this.action("hit");var o=i.data.attack.powerBase+Math.floor(Math.random()*i.data.attack.powerSpace);return this.blood-=o,void new Num("num1",P2Tool.getEgretNum(this.body.position[0]),P2Tool.getEgretY(this.body.position[1])-50,o)}}}},p.action=function(t,e){if(void 0===e&&(e=null),this.actionType!=t&&!this.isHitting&&!this.isDie){if(this.actionType=t,"RightDown"==t||"LeftDown"==t)this.toward=1,this.isAttack=!1,this.isWalking=!0,"RightDown"==t&&(this.toward=-1),this.setMoveClip("walk");else if("AttackDown"==t){if(this.attackCD>0)return;this.isAttack=!0,this.isWalking=!1,this.setMoveClip("attack")}else if("SkillDown"==t){if(this.isSkilling||(this.attackCD=0),this.attackCD>0||this.power<1)return;this.isAttack=!1,this.isWalking=!1,this.setSkill(e)}else"JumpDown"==t?(this.setMoveClip("jump"),this.jumpState="up",this.body.velocity[1]=this.jumpPower):"hit"==t?(this.setMoveClip("hit"),this.isHitting=!0,this.isMissing=!0,this.isWalking=!1,this.hitCD=this.data.hit.CD,this.body.velocity[0]+=this.data.hit.hitMove*this.toward,this.body.velocity[1]+=this.data.hit.hitMove):"die"==t?(this.isDie=!0,this.isHitting=!1,this.isWalking=!1,this.setMoveClip("die")):"stand"==t?(this.setMoveClip("stand"),this.isAttack=!1,this.isWalking=!1,this.isSkilling=!1):"levelUp"==t&&(this.isLevelUp=!0,this.level++,this.power=this.powerMax,this.blood=this.bloodMax,this.expMax+=this.data.expSpace,this.show2=Tool.addMoveClip(this,"hero_levelUp","hero_levelUp",0,0,1,1,!0),this.show2.y=P2Tool.getEgretY(this.body.position[1])+this.data.levelUp.offsetY,this.show2.x=P2Tool.getEgretNum(this.body.position[0])+this.data.levelUp.offsetX,this.show2.addEventListener(egret.Event.COMPLETE,function(){this.removeChild(this.show2),this.isLevelUp=!1,this.show2=null},this));"UpDown"==t&&this.show.x>1840&&this.show.x<1945&&(UIManage.getInstance().hideWelcome(),UIManage.getInstance().showMap())}},p.mcOver=function(t){return void 0===t&&(t=null),"skillShow"==t?(this.removeChild(this.skillShow),this.skillShow.removeEventListener(egret.Event.COMPLETE,this.mcOver.bind(this,"hitEffect"),this),void(this.skillShow=null)):void("die"==this.mcType&&World.P2World.removeBody(this.body))},p.setMoveClip=function(t){this.mcType=t,this.offsetX=this.data[t].offsetX,this.offsetY=this.data[t].offsetY,null!=this.show&&null!=this.show.parent&&this.removeChild(this.show),this.show=Tool.addMoveClip(this,this.data.name,t,0,0,1,-1,!0),this.show.x=P2Tool.getEgretNum(this.body.position[0])+this.offsetX*this.toward,this.show.y=P2Tool.getEgretY(this.body.position[1])+this.offsetY,this.show.addEventListener(egret.Event.LOOP_COMPLETE,this.mcOver,this),this.show.scaleX=this.toward},p.setData=function(t,e){if("blood"==t)return this.blood+=e,this.blood>this.bloodMax&&(this.blood=this.bloodMax),this.blood;if("power"==t){if(this.power+=e,this.power>this.powerMax)this.power=this.powerMax;else if(this.power<0)return this.power-=e,this.power+e;return this.power}return"exp"==t?(this.exp+=e,this.exp>=this.expMax&&(this.exp-=this.expMax,this.action("levelUp")),this.exp):void 0},p.setSkill=function(t){switch(console.log("setSkill   "+t),this.skillIndex=t,this.isSkilling=!0,t){case 0:this.setMoveClip("attack");break;case 1:this.setMoveClip("attack");break;case 2:this.setMoveClip("attack");break;case 6:this.setMoveClip("attack"),this.parent.setChildIndex(this,999),this.skillShow=Tool.addMoveClip(this,"attack_skill6","attack_skill6",P2Tool.getEgretNum(this.body.position[0])+this.data.skill6.skillOffsetX,this.show.y+this.data.skill6.skillOffsetY,this.data.skill6.skillScale,1,!0),this.skillShow.addEventListener(egret.Event.COMPLETE,this.mcOver.bind(this,"skillShow"),this),window.setTimeout(this.setSkillFun.bind(this,this.data.skill6,P2Tool.getEgretNum(this.body.position[0])),1e3)}},p.setSkillFun=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0);for(var i=0,a=GameData.enemyArray.length;a>i;i++){var o=GameData.enemyArray[i],n=P2Tool.getEgretNum(o.body.position[0]);if(!o.isDie)for(var s=0;s<t.range.length;s++){var h=t.range[s];if(h.x+e<n&&h.x+h.space+e>n){o.action("hit",{id:t.id,scale:t.scale,offsetX:t.hitOffsetX,offsetY:t.hitOffsetY});var l=Math.floor(Math.random()*t.powerSpace),r=t.powerBase+l;l>.8*t.powerSpace?new Num("num3",P2Tool.getEgretNum(o.body.position[0]),P2Tool.getEgretY(o.body.position[1])-50,r):new Num("num2",P2Tool.getEgretNum(o.body.position[0]),P2Tool.getEgretY(o.body.position[1])-50,r),o.setData("blood",-r)}}}},e}(egret.DisplayObjectContainer);egret.registerClass(Hero,"Hero");var Item=function(){function t(t,e,i){this._name="1",this.isStand=!1,this.isOver=!1,this.hadPick=!1,this.originY=0,this.range=25,this.missTime=500,this._name=t,this.data=getItem(this._name),this.originY=i,this.show=Tool.addBitmap(UIManage.target.item,this.data.res,e,i,GameData.bodyWidth,GameData.bodyWidth,!1),this.show.anchorOffsetX=this.show.width/2,this.show.anchorOffsetY=this.show.height/2,this.show.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.drop()}var e=(__define,t);return p=e.prototype,p.drop=function(){var t=egret.Tween.get(this.show);t.to({y:this.originY-60,rotation:1080},300,egret.Ease.sineIn).call(function(){var t=egret.Tween.get(this.show);t.to({y:this.originY+10,rotation:720},300).call(this.stand,this)},this)},p.stand=function(){this.isStand=!0;var t=egret.Tween.get(this.show);t.to({y:this.originY},800).call(function(){var t=egret.Tween.get(this.show);t.to({y:this.originY+10},800).call(this.stand,this)},this)},p.pickUp=function(){if(!this.hadPick&&this.isStand){this.hadPick=!0,egret.Tween.removeTweens(this.show);var t=P2Tool.getEgretNum(Hero.getInstance().body.position[0]),e=P2Tool.getEgretY(Hero.getInstance().body.position[1])-30,i=egret.Tween.get(this.show);i.to({x:t,y:e,alpha:0,scaleX:.5,scaleY:.5},400,egret.Ease.backIn).call(this.onRemove,this)}},p.syncFun=function(){if(!this.isOver&&(this.missTime--,this.missTime<0)){var t=egret.Tween.get(this.show);t.to({alpha:0},500).call(this.onRemove,this)}},p.onRemove=function(t){this.isOver=!0,this.show.visible=!1,egret.Tween.removeTweens(this.show),this.show.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},t}();egret.registerClass(Item,"Item");var Num=function(){function t(t,e,i,a,o){void 0===o&&(o=!1),a>0?this.show=Tool.addBitmapText(UIManage.target,t+"_fnt",e,i,.8,a+""):this.show=Tool.addBitmapText(UIManage.target,t+"_fnt",e,i,.8,"m"),this.show.anchorOffsetX+=this.show.measuredWidth/2,this.show.anchorOffsetY+=this.show.measuredHeight/2;var n=egret.Tween.get(this.show);if(n.to({alpha:.5,y:this.show.y-100},800).call(function(){this.show.parent.removeChild(this.show),this.show=null},this),o||"num3"==t){this.tip=Tool.addBitmap(UIManage.target,"num_title_png",0,0,0,0,!1),this.tip.x=this.show.x-this.show.width/2-this.tip.width/3,this.tip.y=this.show.y-this.show.height/2-this.tip.height/2,this.show.parent.setChildIndex(this.show,99);var s=egret.Tween.get(this.tip);s.to({alpha:.5,y:this.tip.y-100},800).call(function(){this.tip.parent.removeChild(this.tip),this.tip=null},this)}}var e=(__define,t);return p=e.prototype,p.onRemove=function(t){t.target.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},t}();egret.registerClass(Num,"Num");var CtrlScene=function(t){function e(){if(t.call(this),this.showing="empty",this.isTip=!1,this.sureAnswer=!1,this.isTop=!1,this.isCtrl=!1,this.abilityIndex=0,this.abilityIsDetail=!1,this.drupShopDrupNum=1,this.drupShopIndex=0,this.drupShopIsDetail=!1,this.weaponShopIndex=0,this.weaponShopIsDetail=!1,this.bagBtnName="Equip",this.bagIndex=0,this.bagIsDetail=!1,this.weaponState=0,null!=e.instance)throw new Error("CtrlScene had been Instanced");e.instance=this,World.instance.addChild(this),this.width=GameData.gameWidth,this.height=GameData.gameHeight}__extends(e,t);var i=(__define,e);return p=i.prototype,e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},p.removeAll=function(){this.removeChildren(),this.topBackgorund=null,this.bloodBar=null,this.powerBar=null,this.expBar=null,this.level=null,this.map=null},p.showTop=function(){this.isTop=!0,this.topBackgorund=Tool.addBitmap(this,"ctrl_topBackground_png",0,0,this.width,80),Tool.addBitmap(this,"ctrl_barBackground_png",195,30,130,40),Tool.addBitmap(this,"ctrl_barBackground_png",345,30,130,40),Tool.addBitmap(this,"ctrl_barBackground_png",495,30,130,40),this.bloodBar=Tool.addBitmap(this,"ctrl_bloodBar_png",200,35,120,30),this.powerBar=Tool.addBitmap(this,"ctrl_powerBar_png",350,35,120,30),this.expBar=Tool.addBitmap(this,"ctrl_expBar_png",500,35,120,30),this.bloodText=Tool.addTextField(this,200,10,0,0,15,0,"血量:"+Hero.getInstance().blood+" / "+Hero.getInstance().bloodMax),this.powerText=Tool.addTextField(this,350,10,0,0,15,0,"法力:"+Hero.getInstance().power+" / "+Hero.getInstance().powerMax),this.expText=Tool.addTextField(this,500,10,0,0,15,0,"经验:"+Hero.getInstance().exp+" / "+Hero.getInstance().expMax),this.level=Tool.addTextField(this,20,20,0,0,30,0,"LEVEL:"+Hero.getInstance().level),this.map=Tool.addTextField(this,700,20,0,0,30,0,UIManage.target.mapData.name),this.bloodBar.scale9Grid=new egret.Rectangle(5,1,98,16),this.powerBar.scale9Grid=new egret.Rectangle(5,1,98,16),this.expBar.scale9Grid=new egret.Rectangle(5,1,110,16)},p.showCtrl=function(t,e){function i(){this.isCtrl=!0,this.ctrlBackgorund=Tool.addBitmap(this,"ctrl_topBackground_png",0,410,this.width,70,!1,!1),this.left=Tool.addBitmap(this,"ctrl_left_png",50,445,50,50,!0,!0),this.right=Tool.addBitmap(this,"ctrl_right_png",120,445,50,50,!0,!0),this.attack=Tool.addBitmap(this,"ctrl_attack_png",680,445,50,50,!0,!0),this.jump=Tool.addBitmap(this,"ctrl_jump_png",750,445,50,50,!0,!0)}if(void 0===t&&(t="war"),void 0===e&&(e=-1),console.log("type   "+t),"war"==t)i.call(this),getDrup(GameData.bag_BloodId)&&(this.bloodNum=Tool.addTextField(this,190,415,30,16,16,0,getDrupNum(GameData.bag_BloodId)),this.bloodNum.textAlign=egret.HorizontalAlign.RIGHT,this.blood=Tool.addBitmap(this,getDrup(GameData.bag_BloodId).res,190,445,50,50,!1,!0),this.blood.touchEnabled=!0,this.blood.addEventListener(egret.TouchEvent.TOUCH_END,this.showCtrl.bind(this,"drup",GameData.bag_BloodId),this)),getDrup(GameData.bag_PowerId)&&(this.powerNum=Tool.addTextField(this,260,415,30,16,16,0,getDrupNum(GameData.bag_PowerId)),this.bloodNum.textAlign=egret.HorizontalAlign.RIGHT,this.power=Tool.addBitmap(this,getDrup(GameData.bag_PowerId).res,260,445,50,50,!1,!0),this.power.touchEnabled=!0,this.power.addEventListener(egret.TouchEvent.TOUCH_END,this.showCtrl.bind(this,"drup",GameData.bag_PowerId),this)),this.skill1=Tool.addBitmap(this,ability.skill1[GameData.skill1Index].icon,540,445,50,50,!0,!0),this.skill2=Tool.addBitmap(this,ability.skill2[GameData.skill2Index].icon,610,445,50,50,!0,!0);else if("welcome"==t)i.call(this),this.level=Tool.addTextField(this,250,425,0,0,30,0,"LEVEL:"+Hero.getInstance().level),this.expText=Tool.addTextField(this,460,415,0,0,15,0,"经验:"+Hero.getInstance().exp+" / "+Hero.getInstance().expMax),this.expBar=Tool.addBitmap(this,"ctrl_expBar_png",460,440,120,30),Tool.addBitmap(this,"ctrl_barBackground_png",455,435,130,40);else if("drup"==t){var a=getDrup(e);Hero.getInstance().setData(a.func,a.funcNum);var o=setDrupNum(e,-1);console.log("func   "+a.func+"Num   "+this[a.func+"Num"]),this[a.func+"Num"].text=o+"",1>o&&(this[a.func+""].alpha=.5,this[a.func+""].touchEnabled=!1)}},p.showTip=function(t){if(!this.isTip){null==this.tipInfo&&(this.tipInfo=Tool.addTextField(this,200,240,400,30,30,16711680,"提示信息")),this.setChildIndex(this.tipInfo,99),this.isTip=!0,this.tipInfo.y=200,this.tipInfo.alpha=1.2,this.tipInfo.text=t;var e=egret.Tween.get(this.tipInfo);e.to({y:this.tipInfo.y-150,alpha:.3},800).call(function(){this.tipInfo.alpha=0,this.isTip=!1},this)}},p.showSure=function(t,e){if(null==this.sureContainer){this.sureContainer=new egret.DisplayObjectContainer,this.sureContainer.width=300,this.sureContainer.height=150,this.sureContainer.anchorOffsetX=150,this.sureContainer.anchorOffsetY=75,this.sureContainer.x=GameData.gameWidth/2,this.sureContainer.y=GameData.gameHeight/2,this.addChild(this.sureContainer);var i=Tool.addBitmap(this.sureContainer,"bag_sureBackground_png",0,0,300,150),a=Tool.addTextField(this.sureContainer,15,20,270,70,20,0,t);a.verticalAlign=egret.VerticalAlign.MIDDLE,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var i=!1;t.localX>30&&t.localX<110&&t.localY>110&&t.localY<140?(this.sureAnswer=!0,i=!0):t.localX>190&&t.localX<275&&t.localY>110&&t.localY<140&&(this.sureAnswer=!1,i=!0),i&&egret.Tween.get(this.sureContainer).to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.sureContainer=Tool.clearItem(this.sureContainer),e()},this)},this),this.sureContainer.scaleX=0,this.sureContainer.scaleY=0;var o=egret.Tween.get(this.sureContainer);o.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}},p.ctrlWeapon=function(t,e){if(void 0===e&&(e=0),"show"==t){if(null!=this.weaponContainer)return;this.weaponContainer=new egret.DisplayObjectContainer,this.weaponContainer.width=500,this.weaponContainer.height=300,this.weaponContainer.anchorOffsetX=250,this.weaponContainer.anchorOffsetY=150,this.weaponContainer.x=GameData.gameWidth/2,this.weaponContainer.y=GameData.gameHeight/2,this.addChild(this.weaponContainer),this.weaponState=1,this.weaponBackground=Tool.addBitmap(this.weaponContainer,"weapon_background"+this.weaponState+"_png",0,0,500,300),this.weaponExpbar=Tool.addBitmap(this.weaponContainer,"weapon_expbar_png",224,47,95,25);var i=Tool.addTextField(this.weaponContainer,192,48,30,25,25,0,"30");i.stroke=.5,this.weaponBackground.touchEnabled=!0,this.weaponBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.localX>465&&t.localX<500&&t.localY>0&&t.localY<50?this.ctrlWeapon("hide"):t.localX>195&&t.localX<305&&t.localY>95&&t.localY<225?this.ctrlWeapon("select"):this.weaponState>0&&(t.localX>175&&t.localX<320&&t.localY>240&&t.localY<285?this.ctrlWeapon("levelUp"):t.localX>42&&t.localX<102&&t.localY>40&&t.localY<105?this.ctrlWeapon("input",1):t.localX>400&&t.localX<460&&t.localY>40&&t.localY<105?this.ctrlWeapon("input",2):t.localX>42&&t.localX<102&&t.localY>200&&t.localY<265?this.ctrlWeapon("input",3):t.localX>400&&t.localX<460&&t.localY>200&&t.localY<265&&this.ctrlWeapon("input",4))},this),this.weaponContainer.alpha=0;var a=egret.Tween.get(this.weaponContainer);a.to({alpha:1},500,egret.Ease.backOut)}else"hide"==t?(console.log("hide"),egret.Tween.get(this.weaponContainer).to({alpha:0},500,egret.Ease.backIn).call(function(){this.weaponContainer=Tool.clearItem(this.weaponContainer)},this)):"select"==t?(console.log("select"),this.weaponBackground.texture=RES.getRes("weapon_background"+this.weaponState+"_png")):"input"==t?console.log("index   "+e):"levelUp"==t&&console.log("levelUp")},p.ctrlData=function(t,e){if(void 0===e&&(e=0),"show"==t){if(null!=this.dataContainer)return;this.dataContainer=new egret.DisplayObjectContainer,this.dataContainer.width=500,this.dataContainer.height=400,this.dataContainer.anchorOffsetX=250,this.dataContainer.anchorOffsetY=200,this.dataContainer.x=GameData.gameWidth/2,this.dataContainer.y=GameData.gameHeight/2-35,this.addChild(this.dataContainer);var i=0,a=Tool.addBitmap(this.dataContainer,"data_background_png",0,0,500,400);Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"职业:弓箭手").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"等级:"+Hero.getInstance().level).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"血量:"+Hero.getInstance().bloodMax).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"法量:"+Hero.getInstance().powerMax).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"物攻:20").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"法攻:23").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"物抗:34").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"法抗:42").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"攻速:21").textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataContainer,300,35+30*i++,170,20,20,0,"移速:13").textAlign=egret.HorizontalAlign.LEFT;
var o;for(o in GameData.data_Equipment)if("ring"==o)GameData.data_Equipment.ring.forEach(function(t,e){-1!=t&&(heroState[o][e].id=t,Tool.addBitmap(this.dataContainer,"item_background"+getEquipment(t).grade+"_png",heroState[o][e].x,heroState[o][e].y,50,50,!1,!0),Tool.addBitmap(this.dataContainer,getEquipment(t).res,heroState[o][e].x,heroState[o][e].y,40,40,!1,!0))}.bind(this));else{if(-1==GameData.data_Equipment[o])continue;heroState[o].id=GameData.data_Equipment[o],Tool.addBitmap(this.dataContainer,"item_background"+getEquipment(GameData.data_Equipment[o]).grade+"_png",heroState[o].x,heroState[o].y,50,50,!1,!0),Tool.addBitmap(this.dataContainer,getEquipment(GameData.data_Equipment[o]).res,heroState[o].x,heroState[o].y,40,40,!1,!0)}a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.localX>475&&t.localX<500&&t.localY>0&&t.localY<25)this.ctrlData("hide");else{if(this.dataAddContainer||this.dataDetailContainer)return;for(o in heroState)if("ring"==o){for(var e=0;e<heroState[o].length;e++)if(t.localX>heroState[o][e].x-25&&t.localX<heroState[o][e].x+25&&t.localY>heroState[o][e].y-25&&t.localY<heroState[o][e].y+25)return this.dataSelectObj={},this.dataSelectObj.x=heroState[o][e].x,this.dataSelectObj.y=heroState[o][e].y,this.dataSelectObj._type=o,this.dataSelectObj._index=e,-1==heroState[o][e].id?(this.dataAddType="ring",void this.ctrlData("showAdd")):(this.dataSelectObj.id=heroState[o][e].id,void this.ctrlData("showDetail"))}else if(t.localX>heroState[o].x-25&&t.localX<heroState[o].x+25&&t.localY>heroState[o].y-25&&t.localY<heroState[o].y+25)return this.dataSelectObj={},this.dataSelectObj.x=heroState[o].x,this.dataSelectObj.y=heroState[o].y,this.dataSelectObj._type=o,-1==heroState[o].id?(this.dataAddType=o,void this.ctrlData("showAdd")):(this.dataSelectObj.id=heroState[o].id,void this.ctrlData("showDetail"))}},this),this.dataContainer.scaleX=0,this.dataContainer.scaleY=0;var n=egret.Tween.get(this.dataContainer);n.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if(this.dataAddContainer||this.dataDetailContainer)return;egret.Tween.get(this.dataContainer).to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.dataContainer),this.dataContainer=null,this.dataAddContainer=null,this.dataDetailContainer=null,this.dataAddData=null,this.dataAddItems=null,this.dataAddIcon=null,this.dataSelectObj=null,this.dataContainer=null,this.dataAddType=null,this.dataOldY=null,this.showing="empty"},this)}else if("showAdd"==t){if(this.dataAddContainer)return;this.dataAddItems=[],this.dataAddIcon=[],this.dataAddContainer=new egret.DisplayObjectContainer,this.dataAddContainer.width=100,this.dataAddContainer.height=400,this.dataAddContainer.anchorOffsetX=this.dataAddContainer.width/2,this.dataAddContainer.anchorOffsetY=this.dataAddContainer.height/2,this.dataAddContainer.x=200,this.dataAddContainer.y=GameData.gameHeight/2-35;var s=Tool.addBitmap(this.dataAddContainer,"data_addScene_png",0,0,100,400);s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.localX>75&&t.localX<100&&t.localY>0&&t.localY<25&&this.ctrlData("hideAdd")},this),this.dataAddData=[];for(var h,i=0;i<GameData.bag_Equipment.length;i++)h=getEquipment(GameData.bag_Equipment[i]),h._type==this.dataAddType&&this.dataAddData.push({id:GameData.bag_Equipment[i],grade:h.grade});var l=new eui.Group;l.touchEnabled=!0,l.width=this.dataAddContainer.width,l.height=60*this.dataAddData.length,l.cacheAsBitmap=!0;for(var i=0;i<this.dataAddData.length;i++){var h=getEquipment(this.dataAddData[i].id);this.dataAddItems.push(Tool.addBitmap(l,"item_background"+h.grade+"_png",l.width/2,60*i+32,60,58,!1,!0)),this.dataAddIcon.push(Tool.addBitmap(l,h.res,l.width/2,60*i+32,50,50,!1,!0)),this.dataAddIcon[i].touchEnabled=!0,this.dataAddIcon[i].addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){this.dataOldY=t.stageY},this),this.dataAddIcon[i].addEventListener(egret.TouchEvent.TOUCH_END,function(t){if(Math.abs(t.stageY-this.dataOldY)<10)for(var e=0;e<this.dataAddData.length;e++)if(t.target==this.dataAddIcon[e])return this.dataSelectObj.id=this.dataAddData[e].id,void this.ctrlData("showDetail",1)},this)}var r=new eui.Group,d=new eui.Scroller;d.x=r.x,d.y=30,d.width=100,d.height=360,d.viewport=r,d.touchEnabled=!0,this.dataAddContainer.addChild(d),r.addChild(l),this.addChild(this.dataAddContainer),this.swapChildren(this.dataAddContainer,this.dataContainer),egret.Tween.get(this.dataAddContainer).to({x:100},500,egret.Ease.backOut)}else if("hideAdd"==t){var n=egret.Tween.get(this.dataAddContainer);n.to({x:200},500,egret.Ease.backIn).call(function(){this.removeChild(this.dataAddContainer),this.dataAddContainer=null,this.dataAddItems=null,this.dataAddIcon=null},this)}else if("showDetail"==t){if(this.dataDetailContainer)return;this.dataDetailContainer=new egret.DisplayObjectContainer,this.dataDetailContainer.width=300,this.dataDetailContainer.height=150,this.dataDetailContainer.anchorOffsetX=150,this.dataDetailContainer.anchorOffsetY=75,this.dataDetailContainer.x=this.dataContainer.width/2,this.dataDetailContainer.y=this.dataContainer.height/2,this.dataContainer.addChild(this.dataDetailContainer);var p=getEquipment(this.dataSelectObj.id),a=Tool.addBitmap(this.dataDetailContainer,"data_detailScene"+e+"_png",0,0,300,150);Tool.addBitmap(this.dataDetailContainer,p.res,28,30,50,50),Tool.addTextField(this.dataDetailContainer,100,23,80,20,16,0,p.name).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataDetailContainer,97,47,180,41,12,0,p.info).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.dataDetailContainer,200,23,130,75,15,0,"售价:"+p.cost+"金币").textAlign=egret.HorizontalAlign.LEFT,a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.localX>20&&t.localX<100&&t.localY>110&&t.localY<140){if(0==e){for(var i,a=0;a<this.dataContainer.$children.length;a++)if(i=this.dataContainer.getChildAt(a),i.x==this.dataSelectObj.x&&i.y==this.dataSelectObj.y){"ring"==this.dataSelectObj._type?(GameData.bag_Equipment.push(GameData.data_Equipment.ring[this.dataSelectObj._index]),heroState.ring[this.dataSelectObj._index].id=-1,GameData.data_Equipment.ring[this.dataSelectObj._index]=-1):(GameData.bag_Equipment.push(GameData.data_Equipment[this.dataSelectObj._type]),heroState[this.dataSelectObj._type].id=-1,GameData.data_Equipment[this.dataSelectObj._type]=-1),this.dataContainer.removeChildAt(a);break}for(var a=0;a<this.dataContainer.$children.length;a++)if(i=this.dataContainer.getChildAt(a),i.x==this.dataSelectObj.x&&i.y==this.dataSelectObj.y)return this.dataContainer.removeChildAt(a),void this.ctrlData("hideDetail")}else if(1==e){this.showTip("装备成功！"),this.ctrlData("hideAdd"),this.ctrlData("hideDetail"),console.log("_type  "+this.dataSelectObj._type),"ring"==this.dataSelectObj._type?(heroState.ring[this.dataSelectObj._index].id=this.dataSelectObj.id,GameData.data_Equipment.ring[this.dataSelectObj._index]=this.dataSelectObj.id):(heroState[this.dataSelectObj._type].id=this.dataSelectObj.id,GameData.data_Equipment[this.dataSelectObj._type]=this.dataSelectObj.id);for(var a=0;a<GameData.bag_Equipment.length;a++)if(GameData.bag_Equipment[a]==this.dataSelectObj.id){GameData.bag_Equipment.splice(a,1);break}var o=Tool.addBitmap(this.dataContainer,"item_background"+getEquipment(this.dataSelectObj.id).grade+"_png",this.dataSelectObj.x,this.dataSelectObj.y,50,50,!1,!0),n=Tool.addBitmap(this.dataContainer,getEquipment(this.dataSelectObj.id).res,this.dataSelectObj.x,this.dataSelectObj.y,40,40,!1,!0);this.dataContainer.setChildIndex(n,2),this.dataContainer.setChildIndex(o,2)}}else t.localX>200&&t.localX<280&&t.localY>110&&t.localY<140&&this.ctrlData("hideDetail")},this),this.dataDetailContainer.scaleX=0,this.dataDetailContainer.scaleY=0;var n=egret.Tween.get(this.dataDetailContainer);n.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hideDetail"==t){var n=egret.Tween.get(this.dataDetailContainer);n.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.dataContainer.removeChild(this.dataDetailContainer),this.dataDetailContainer=null,this.showing="heroState"},this)}},p.ctrlBag=function(t,e){if(void 0===e&&(e=!1),"show"==t){if("empty"!=this.showing)return;this.showing="bag",this.bagIcon=[],this.bagItems=[],this.bagItemNum=[],this.bagContainer=new egret.DisplayObjectContainer,this.bagContainer.width=430,this.bagContainer.height=320,this.bagContainer.anchorOffsetX=this.bagContainer.width/2,this.bagContainer.anchorOffsetY=this.bagContainer.height/2,this.bagContainer.x=this.width/2,this.bagContainer.y=210,this.bagBackground=Tool.addBitmap(this.bagContainer,"bag_background_png",0,0,430,320),this.bag_btnEquipment=Tool.addBitmap(this.bagContainer,"bag_btnEquipment1_png",30,10,80,35),this.bag_btnItem=Tool.addBitmap(this.bagContainer,"bag_btnItem0_png",120,10,80,35),this.bag_btnPiece=Tool.addBitmap(this.bagContainer,"bag_btnPiece0_png",210,10,80,35),this.bag_btnDrup=Tool.addBitmap(this.bagContainer,"bag_btnDrup0_png",300,10,80,35),this.bagGoldNum=Tool.addTextField(this.bagContainer,340,285,80,18,18,0,GameData.goldNum),this.bagDiamondNum=Tool.addTextField(this.bagContainer,215,285,90,18,18,0,GameData.diamondNum),this.bagGoldNum.textAlign=egret.HorizontalAlign.LEFT,this.bagDiamondNum.textAlign=egret.HorizontalAlign.LEFT,this.bagBackground.touchEnabled=!0,this.bag_btnEquipment.touchEnabled=!0,this.bag_btnItem.touchEnabled=!0,this.bag_btnPiece.touchEnabled=!0,this.bag_btnDrup.touchEnabled=!0,this.bagBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),t.localX>390&&t.localX<420&&t.localY>10&&t.localY<40&&this.ctrlBag("hide")},this),this.bag_btnEquipment.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),"Equipment"!=this.bagBtnName&&(this.bagBtnName="Equipment",this.ctrlBag("changeBtn"))},this),this.bag_btnItem.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),"Item"!=this.bagBtnName&&(this.bagBtnName="Item",this.ctrlBag("changeBtn"))},this),this.bag_btnPiece.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),"Piece"!=this.bagBtnName&&(this.bagBtnName="Piece",this.ctrlBag("changeBtn"))},this),this.bag_btnDrup.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stopImmediatePropagation(),"Drup"!=this.bagBtnName&&(this.bagBtnName="Drup",this.ctrlBag("changeBtn"))},this),this.bagBtnName="Equipment",this.bagItemGroup=new eui.Group,this.bagItemGroup.touchEnabled=!0,this.bagItemGroup.width=400,this.bagItemGroup.height=350,this.bagItemGroup.cacheAsBitmap=!0;for(var i=0;5>i;i++){this.bagItems.push(Tool.addBitmap(this.bagItemGroup,"bag_item_png",0,70*i,400,65));for(var a=0;7>a;a++){var o=7*i+a;if(o>=GameData["bag_"+this.bagBtnName].length)break;var n=Math.floor(GameData["bag_"+this.bagBtnName][o]),s=Math.floor(100*(GameData["bag_"+this.bagBtnName][o]-n)),h=window["get"+this.bagBtnName](n);this.bagIcon.push(Tool.addBitmap(this.bagItemGroup,h.res,34+55.2*a,70*i+32,40,40,!1,!0)),this.bagItemNum.push(Tool.addTextField(this.bagItemGroup,35+55.2*a,70*i+40,20,15,15,0,s+"")),this.bagItemNum[o].stroke=.5,this.bagItemNum[o].visible=!1,this.bagItemNum[o].textAlign=egret.HorizontalAlign.RIGHT,this.bagIcon[o].touchEnabled=!0,this.bagIcon[o].addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){for(var e=0;e<this.bagIcon.length;e++)if(t.target==this.bagIcon[e])return this.bagIndex=e,void this.ctrlBag("showDetail")},this)}}var l=new eui.Group,r=new eui.Scroller;r.x=15,r.y=58,r.width=400,r.height=210,r.viewport=l,r.touchEnabled=!0,this.bagContainer.addChild(r),l.addChild(this.bagItemGroup),this.addChild(this.bagContainer),this.bagContainer.scaleX=0,this.bagContainer.scaleY=0;var d=egret.Tween.get(this.bagContainer);d.to({scaleX:1,scaleY:1},500,egret.Ease.backOut),this.bagBloodBox=Tool.addBitmap(this.bagItemGroup,"bag_bloodBox_png",0,0,65,60,!1,!0),this.bagPowerBox=Tool.addBitmap(this.bagItemGroup,"bag_powerBox_png",0,0,65,60,!1,!0),this.bagBloodBox.visible=!1,this.bagPowerBox.visible=!1}else if("hide"==t){if(this.bagDetailContainer)return;if("empty"==this.showing)return;var d=egret.Tween.get(this.bagContainer);d.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.bagContainer),this.bagDetailContainer=null,this.bagBackground=null,this.bagContainer=null,this.bagItemGroup=null,this.bagIsDetail=null,this.bagIndex=null,this.bagItems=null,this.bagIcon=null,this.bag_btnEquipment=null,this.bag_btnItem=null,this.bagBloodBox=null,this.bag_btnPiece=null,this.bagItemNum=null,this.bagDiamondNum=null,this.bagBtnName=null,this.showing="empty"},this)}else if("changeBtn"==t){if(this.bagDetailContainer&&!e)return;console.log("changeBtn"),this.bagGoldNum.text=GameData.goldNum+"",this.bagDiamondNum.text=GameData.diamondNum+"",this.bag_btnEquipment.texture=RES.getRes("bag_btnEquipment0_png"),this.bag_btnItem.texture=RES.getRes("bag_btnItem0_png"),this.bag_btnPiece.texture=RES.getRes("bag_btnPiece0_png"),this.bag_btnDrup.texture=RES.getRes("bag_btnDrup0_png"),this["bag_btn"+this.bagBtnName].texture=RES.getRes("bag_btn"+this.bagBtnName+"1_png");for(var i=0;i<this.bagIcon.length;i++)Tool.clearItem(this.bagIcon[i]),Tool.clearItem(this.bagItemNum[i]);this.bagIcon.length=0,this.bagItemNum.length=0;for(var i=0;5>i;i++){this.bagItems.push(Tool.addBitmap(this.bagItemGroup,"bag_item_png",0,70*i,400,65));for(var a=0;7>a;a++){var o=7*i+a;if(o>=GameData["bag_"+this.bagBtnName].length)break;var n=Math.floor(GameData["bag_"+this.bagBtnName][o]),s=Math.floor(100*(GameData["bag_"+this.bagBtnName][o]-n)),h=window["get"+this.bagBtnName](n);this.bagIcon.push(Tool.addBitmap(this.bagItemGroup,h.res,34+55.2*a,70*i+32,40,40,!1,!0)),this.bagItemNum.push(Tool.addTextField(this.bagItemGroup,35+55.2*a,70*i+40,20,15,15,0,s+"")),"Equipment"==this.bagBtnName&&(this.bagItemNum[o].visible=!1),this.bagItemNum[o].stroke=.5,this.bagItemNum[o].textAlign=egret.HorizontalAlign.RIGHT,this.bagIcon[o].touchEnabled=!0,this.bagIcon[o].addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){for(var e=0;e<this.bagIcon.length;e++)if(t.target==this.bagIcon[e])return this.bagIndex=e,void this.ctrlBag("showDetail")},this)}}if(this.bagBloodBox.visible=!1,this.bagPowerBox.visible=!1,"Drup"!==this.bagBtnName)return;GameData.bag_Drup.forEach(function(t,e){GameData.bag_BloodId==Math.floor(t)?(this.bagItemGroup.setChildIndex(this.bagBloodBox,99),this.bagBloodBox.visible=!0,this.bagBloodBox.x=34+e%7*55.2,this.bagBloodBox.y=70*Math.floor(e/7)+32):GameData.bag_PowerId==Math.floor(t)&&(this.bagItemGroup.setChildIndex(this.bagPowerBox,99),this.bagPowerBox.visible=!0,this.bagPowerBox.x=34+e%7*55.2,this.bagPowerBox.y=70*Math.floor(e/7)+32)},this)}else if("showDetail"==t){if(this.bagDetailContainer)return;this.bagIsDetail=!0,this.bagDetailContainer=new egret.DisplayObjectContainer,this.bagDetailContainer.width=300,this.bagDetailContainer.height=150,this.bagDetailContainer.anchorOffsetX=150,this.bagDetailContainer.anchorOffsetY=75,this.bagDetailContainer.x=this.bagContainer.width/2,this.bagDetailContainer.y=this.bagContainer.height/2,this.bagContainer.addChild(this.bagDetailContainer);var n=Math.floor(GameData["bag_"+this.bagBtnName][this.bagIndex]),s=Math.floor(100*(GameData["bag_"+this.bagBtnName][this.bagIndex]-n)),h=window["get"+this.bagBtnName](n),p=Tool.addBitmap(this.bagDetailContainer,"bag_detail"+this.bagBtnName+"_png",0,0,300,150);Tool.addBitmap(this.bagDetailContainer,h.res,28,30,50,50),Tool.addTextField(this.bagDetailContainer,100,23,80,20,16,0,h.name).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.bagDetailContainer,97,47,180,41,12,0,h.info).textAlign=egret.HorizontalAlign.LEFT,Tool.addTextField(this.bagDetailContainer,200,23,130,75,15,0,"售价:"+h.cost).textAlign=egret.HorizontalAlign.LEFT,p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.localX>20&&t.localX<100&&t.localY>110&&t.localY<140)this.showSure("确定全部卖出吗？",function(t,e){var i=Math.floor(GameData["bag_"+this.bagBtnName][this.bagIndex]),e=Math.floor(100*(GameData["bag_"+this.bagBtnName][this.bagIndex]-i)),a=window["get"+this.bagBtnName](i);this.sureAnswer&&(console.log("卖出成功"),"Equipment"==this.bagBtnName?(GameData.goldNum+=a.cost,GameData["bag_"+this.bagBtnName].splice([this.bagIndex],1)):(GameData.goldNum+=a.cost*e,GameData["bag_"+this.bagBtnName].splice([this.bagIndex],1)),this.ctrlBag("changeBtn",!0),this.ctrlBag("hideDetail"))}.bind(this));else if(t.localX>110&&t.localX<190&&t.localY>110&&t.localY<140){if("Equipment"==this.bagBtnName){var e=Math.floor(GameData.bag_Equipment[this.bagIndex]),i=window.getEquipment(e);if("ring"==i._type){for(var a=0;a<GameData.data_Equipment.ring.length;a++)if(-1==GameData.data_Equipment.ring[a])return GameData["bag_"+this.bagBtnName].splice([this.bagIndex],1),GameData.data_Equipment.ring[a]=e,this.showTip("装备成功！"),GameData.saveData(),this.ctrlBag("changeBtn",!0),void this.ctrlBag("hideDetail");this.showTip("请先卸下原装备")}else-1==GameData.data_Equipment[i._type]?(GameData["bag_"+this.bagBtnName].splice([this.bagIndex],1),GameData.data_Equipment[i._type]=e,this.showTip("装备成功"),GameData.saveData(),this.ctrlBag("changeBtn",!0),this.ctrlBag("hideDetail")):this.showTip("请先卸下原装备")}else if("Piece"==this.bagBtnName)console.log("合成成功");else if("Drup"==this.bagBtnName){var e=Math.floor(GameData["bag_"+this.bagBtnName][this.bagIndex]),o=window["get"+this.bagBtnName](e);"blood"==o.func?(this.bagBloodBox.visible=!0,GameData.bag_BloodId=e,this.bagBloodBox.x=34+this.bagIndex%7*55.2,this.bagBloodBox.y=70*Math.floor(this.bagIndex/7)+32,this.bagItemGroup.setChildIndex(this.bagBloodBox,99)):"power"==o.func?(this.bagPowerBox.visible=!0,GameData.bag_PowerId=e,this.bagPowerBox.x=34+this.bagIndex%7*55.2,this.bagPowerBox.y=70*Math.floor(this.bagIndex/7)+32,this.bagItemGroup.setChildIndex(this.bagPowerBox,99)):console.log("使用成功"),this.showTip("携带成功"),this.ctrlBag("hideDetail")}}else t.localX>200&&t.localX<280&&t.localY>110&&t.localY<140&&this.ctrlBag("hideDetail")},this),this.bagDetailContainer.scaleX=0,this.bagDetailContainer.scaleY=0;var d=egret.Tween.get(this.bagDetailContainer);d.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hideDetail"==t){if(!this.bagIsDetail)return;this.bagIsDetail=!1;var d=egret.Tween.get(this.bagDetailContainer);d.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.bagContainer.removeChild(this.bagDetailContainer),this.bagDetailContainer=null,this.showing="bag"},this)}},p.ctrlDrupShop=function(t,e){if(void 0===e&&(e=1),"show"==t){if("empty"!=this.showing)return;this.drupShopData=drupShop,this.showing="drupShop",this.drupShopItems=[],this.drupShopIcon=[],this.drupShopName=[],this.drupShopInfo=[],this.drupShopCost=[],this.drupShopContainer=new egret.DisplayObjectContainer,this.drupShopContainer.width=500,this.drupShopContainer.height=400,this.drupShopContainer.anchorOffsetX=this.drupShopContainer.width/2,this.drupShopContainer.anchorOffsetY=this.drupShopContainer.height/2,this.drupShopContainer.x=this.width/2,this.drupShopContainer.y=210,this.drupShopBackground=Tool.addBitmap(this.drupShopContainer,"drupShop_background_png",0,0,500,400),this.drupShopBackground.touchEnabled=!0,this.drupShopBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.localX>205&&t.localX<250&&t.localY>345&&t.localY<390&&this.ctrlDrupShop("hide")},this),this.drupShopItemGroup=new eui.Group,this.drupShopItemGroup.touchEnabled=!0,this.drupShopItemGroup.width=370,this.drupShopItemGroup.height=70*this.drupShopData.length,this.drupShopItemGroup.cacheAsBitmap=!0;for(var i=0;i<this.drupShopData.length;i++){var a=getDrup(this.drupShopData[i]);this.drupShopItems.push(Tool.addBitmap(this.drupShopItemGroup,"drupShop_item_png",0,70*i,370,65)),this.drupShopIcon.push(Tool.addBitmap(this.drupShopItemGroup,a.res,17,70*i+10,40,40)),this.drupShopName.push(Tool.addTextField(this.drupShopItemGroup,80,70*i+8,0,0,20,0,a.name)),this.drupShopCost.push(Tool.addTextField(this.drupShopItemGroup,290,70*i+10,0,0,18,0,a.cost)),this.drupShopInfo.push(Tool.addTextField(this.drupShopItemGroup,80,70*i+38,0,0,15,0,a.info)),this.drupShopName[i].textAlign=egret.HorizontalAlign.LEFT,this.drupShopInfo[i].textAlign=egret.HorizontalAlign.LEFT,this.drupShopIcon[i].touchEnabled=!0,this.drupShopIcon[i].addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){for(var e=0;e<this.drupShopIcon.length;e++)if(t.target==this.drupShopIcon[e])return this.drupShopIndex=e,void this.ctrlDrupShop("showDetail")},this)}var o=new eui.Group,n=new eui.Scroller;n.x=47,n.y=105,n.width=370,n.height=210,n.viewport=o,n.touchEnabled=!0,this.drupShopContainer.addChild(n),o.addChild(this.drupShopItemGroup),this.addChild(this.drupShopContainer),this.drupShopContainer.scaleX=0,this.drupShopContainer.scaleY=0;var s=egret.Tween.get(this.drupShopContainer);s.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if(this.drupShopDetailContainer)return;if("empty"==this.showing)return;var s=egret.Tween.get(this.drupShopContainer);s.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.drupShopContainer),this.drupShopDetailContainer=null,this.drupShopDrupNumText=null,this.drupShopBackground=null,this.drupShopContainer=null,this.drupShopItemGroup=null,this.drupShopIsDetail=null,this.drupShopDrupNum=null,this.drupShopIndex=null,this.drupShopItems=null,this.drupShopIcon=null,this.drupShopName=null,this.drupShopInfo=null,this.drupShopCost=null,this.drupShopData=null,this.drupShopSum=null,this.showing="empty"},this)}else if("showDetail"==t){if(this.drupShopDetailContainer)return;this.drupShopDrupNum=1,this.drupShopIsDetail=!0,this.drupShopDetailContainer=new egret.DisplayObjectContainer,this.drupShopDetailContainer.width=300,this.drupShopDetailContainer.height=180,this.drupShopDetailContainer.anchorOffsetX=150,this.drupShopDetailContainer.anchorOffsetY=90,this.drupShopDetailContainer.x=this.drupShopContainer.width/2,this.drupShopDetailContainer.y=this.drupShopContainer.height/2,this.drupShopContainer.addChild(this.drupShopDetailContainer);var a=getDrup(this.drupShopData[this.drupShopIndex]),h=Tool.addBitmap(this.drupShopDetailContainer,"drupShop_detail_png",0,0,300,180),l=(Tool.addBitmap(this.drupShopDetailContainer,a.res,27,33,50,50),Tool.addTextField(this.drupShopDetailContainer,12,98,80,20,16,16777215,a.name),Tool.addTextField(this.drupShopDetailContainer,90,25,90,90,15,16777215,a.info)),r=Tool.addTextField(this.drupShopDetailContainer,190,70,60,15,15,16777215,"单价:"+a.cost);this.drupShopSum=Tool.addTextField(this.drupShopDetailContainer,190,95,100,15,15,16777215,"总额:"+a.cost),this.drupShopDrupNumText=new eui.EditableText,this.drupShopDrupNumText.x=215,this.drupShopDrupNumText.y=40,this.drupShopDrupNumText.width=40,this.drupShopDrupNumText.size=15,this.drupShopDrupNumText.height=15,this.drupShopDrupNumText.textColor=16777215,this.drupShopDrupNumText.textAlign=egret.HorizontalAlign.CENTER,this.drupShopDrupNumText.text="01",this.drupShopDetailContainer.addChild(this.drupShopDrupNumText),this.drupShopDrupNumText.addEventListener(egret.Event.FOCUS_OUT,function(){var t=parseInt(this.drupShopDrupNumText.text);this.ctrlDrupShop("update",t)},this),r.textAlign=egret.HorizontalAlign.LEFT,l.textAlign=egret.HorizontalAlign.LEFT,this.drupShopSum.textAlign=egret.HorizontalAlign.LEFT,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.localX>188&&t.localX<203&&t.localY>40&&t.localY<58)this.ctrlDrupShop("update",--this.drupShopDrupNum);else if(t.localX>267&&t.localX<283&&t.localY>40&&t.localY<58)this.ctrlDrupShop("update",++this.drupShopDrupNum);else if(t.localX>40&&t.localX<135&&t.localY>105&&t.localY<165)if(16711680==this.drupShopSum.textColor)this.showTip("金币不足");else{for(var e=parseInt(this.drupShopSum.text.substr(3,this.drupShopSum.text.length)),i=!1,a=0;a<GameData.bag_Drup.length;a++)if(this.drupShopData[this.drupShopIndex]==Math.floor(GameData.bag_Drup[a])){GameData.bag_Drup[a]+=.01*this.drupShopDrupNum,i=!0;break}if(!i){var o=this.drupShopData[this.drupShopIndex]+.01*this.drupShopDrupNum;GameData.bag_Drup.push(o)}GameData.goldNum-=e,GameData.saveData(),this.showTip("购买成功"),this.ctrlDrupShop("hideDetail")}else t.localX>190&&t.localX<260&&t.localY>135&&t.localY<165&&this.ctrlDrupShop("hideDetail")},this),this.drupShopDetailContainer.scaleX=0,this.drupShopDetailContainer.scaleY=0;var s=egret.Tween.get(this.drupShopDetailContainer);s.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hideDetail"==t){if(!this.drupShopIsDetail)return;this.drupShopIsDetail=!1;var s=egret.Tween.get(this.drupShopDetailContainer);s.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.drupShopContainer.removeChild(this.drupShopDetailContainer),this.drupShopDetailContainer=null,this.drupShopDrupNumText=null,this.drupShopSum=null,this.showing="drupShop"},this)}else if("update"==t){console.log("update"+e),this.drupShopDrupNum=e,this.drupShopDrupNum<1?this.drupShopDrupNum=1:this.drupShopDrupNum>99&&(this.drupShopDrupNum=99),this.drupShopDrupNumText.text=Tool.setZero(this.drupShopDrupNum,2);var d=getDrup(this.drupShopData[this.drupShopIndex]).cost*this.drupShopDrupNum;this.drupShopSum.text="总额:"+d,d<GameData.goldNum?this.drupShopSum.textColor=16777215:this.drupShopSum.textColor=16711680}},p.ctrlWeaponShop=function(t,e){if(void 0===e&&(e=1),"show"==t){if("empty"!=this.showing)return;this.weaponShopData=weaponShop,this.showing="weaponShop",this.weaponShopItems=[],this.weaponShopIcon=[],this.weaponShopName=[],this.weaponShopInfo=[],this.weaponShopCost=[],this.weaponShopContainer=new egret.DisplayObjectContainer,this.weaponShopContainer.width=500,this.weaponShopContainer.height=400,this.weaponShopContainer.anchorOffsetX=this.weaponShopContainer.width/2,this.weaponShopContainer.anchorOffsetY=this.weaponShopContainer.height/2,this.weaponShopContainer.x=this.width/2,this.weaponShopContainer.y=210,this.weaponShopBackground=Tool.addBitmap(this.weaponShopContainer,"weaponShop_background_png",0,0,550,400),this.weaponShopBackground.touchEnabled=!0,this.weaponShopBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.localX>200&&t.localX<260&&t.localY>345&&t.localY<385&&this.ctrlWeaponShop("hide")},this),this.weaponShopItemGroup=new eui.Group,this.weaponShopItemGroup.touchEnabled=!0,this.weaponShopItemGroup.width=370,this.weaponShopItemGroup.height=70*this.weaponShopData.length,this.weaponShopItemGroup.cacheAsBitmap=!0;for(var i=0;i<this.weaponShopData.length;i++){var a=getEquipment(this.weaponShopData[i]);this.weaponShopItems.push(Tool.addBitmap(this.weaponShopItemGroup,"weaponShop_item_png",0,70*i,370,65)),this.weaponShopIcon.push(Tool.addBitmap(this.weaponShopItemGroup,a.res,17,70*i+10,40,40)),this.weaponShopName.push(Tool.addTextField(this.weaponShopItemGroup,80,70*i+8,0,0,20,0,a.name)),this.weaponShopCost.push(Tool.addTextField(this.weaponShopItemGroup,290,70*i+10,0,0,18,0,a.cost)),this.weaponShopInfo.push(Tool.addTextField(this.weaponShopItemGroup,80,70*i+38,0,0,15,0,a.info)),this.weaponShopName[i].textAlign=egret.HorizontalAlign.LEFT,this.weaponShopInfo[i].textAlign=egret.HorizontalAlign.LEFT,this.weaponShopIcon[i].touchEnabled=!0,this.weaponShopIcon[i].addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){for(var e=0;e<this.weaponShopIcon.length;e++)if(t.target==this.weaponShopIcon[e])return this.weaponShopIndex=e,void this.ctrlWeaponShop("showDetail")},this)}var o=new eui.Group,n=new eui.Scroller;n.x=47,n.y=105,n.width=370,n.height=210,n.viewport=o,n.touchEnabled=!0,this.weaponShopContainer.addChild(n),o.addChild(this.weaponShopItemGroup),this.addChild(this.weaponShopContainer),this.weaponShopContainer.scaleX=0,this.weaponShopContainer.scaleY=0;var s=egret.Tween.get(this.weaponShopContainer);s.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if(this.weaponShopDetailContainer)return;if("empty"==this.showing)return;var s=egret.Tween.get(this.weaponShopContainer);s.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.weaponShopContainer),this.weaponShopDetailContainer=null,this.weaponShopBackground=null,this.weaponShopContainer=null,this.weaponShopItemGroup=null,this.weaponShopIsDetail=null,this.weaponShopIndex=null,this.weaponShopItems=null,this.weaponShopIcon=null,this.weaponShopName=null,this.weaponShopInfo=null,this.weaponShopCost=null,this.weaponShopData=null,this.weaponShopSum=null,this.showing="empty"},this)}else if("showDetail"==t){if(this.weaponShopDetailContainer)return;this.weaponShopIsDetail=!0,this.weaponShopDetailContainer=new egret.DisplayObjectContainer,this.weaponShopDetailContainer.width=300,this.weaponShopDetailContainer.height=180,this.weaponShopDetailContainer.anchorOffsetX=150,this.weaponShopDetailContainer.anchorOffsetY=90,this.weaponShopDetailContainer.x=this.weaponShopContainer.width/2,this.weaponShopDetailContainer.y=this.weaponShopContainer.height/2,this.weaponShopContainer.addChild(this.weaponShopDetailContainer);var a=getEquipment(this.weaponShopData[this.weaponShopIndex]),h=Tool.addBitmap(this.weaponShopDetailContainer,"weaponShop_detail_png",0,0,300,180),l=(Tool.addBitmap(this.weaponShopDetailContainer,a.res,27,33,50,50),Tool.addTextField(this.weaponShopDetailContainer,12,98,80,20,16,16777215,a.name),Tool.addTextField(this.weaponShopDetailContainer,90,50,195,70,15,16777215,a.info));this.weaponShopSum=Tool.addTextField(this.weaponShopDetailContainer,90,28,130,16,16,16777215,"售价:"+a.cost),this.weaponShopSum.textAlign=egret.HorizontalAlign.LEFT,l.textAlign=egret.HorizontalAlign.LEFT;var r=parseInt(this.weaponShopSum.text.substr(3,this.weaponShopSum.text.length));GameData.goldNum<r&&(this.weaponShopSum.textColor=16711680),h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.localX>40&&t.localX<135&&t.localY>105&&t.localY<165?16711680==this.weaponShopSum.textColor?this.showTip("金币不足"):(GameData.goldNum-=parseInt(this.weaponShopSum.text.substr(3,this.weaponShopSum.text.length)),GameData.bag_Equipment.push(this.weaponShopData[this.weaponShopIndex]),this.showTip("购买成功"),this.ctrlWeaponShop("hideDetail")):t.localX>190&&t.localX<260&&t.localY>135&&t.localY<165&&this.ctrlWeaponShop("hideDetail")},this),this.weaponShopDetailContainer.scaleX=0,this.weaponShopDetailContainer.scaleY=0;var s=egret.Tween.get(this.weaponShopDetailContainer);s.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hideDetail"==t){if(!this.weaponShopIsDetail)return;this.weaponShopIsDetail=!1;var s=egret.Tween.get(this.weaponShopDetailContainer);s.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.weaponShopContainer.removeChild(this.weaponShopDetailContainer),this.weaponShopDetailContainer=null,this.weaponShopSum=null,this.showing="weaponShop"},this)}},p.ctrlAbility=function(t){if("show"==t){if("empty"!=this.showing)return;this.abilityData=ability,this.showing="ability",this.abilityIcon=[],this.abilityText=[],this.abilityContainer=new egret.DisplayObjectContainer,this.abilityContainer.width=700,this.abilityContainer.height=420,this.abilityContainer.anchorOffsetX=this.abilityContainer.width/2,this.abilityContainer.anchorOffsetY=this.abilityContainer.height/2,this.abilityContainer.x=this.width/2,this.abilityContainer.y=this.height/2,this.abilityBackground=Tool.addBitmap(this.abilityContainer,"ability_background_png",0,0,this.abilityContainer.width,this.abilityContainer.height),this.abilityBackground.touchEnabled=!0,this.abilityBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(!this.abilityIsDetail){t.stageX>270&&t.stageX<425&&t.stageY>360&&t.stageY<390&&this.ctrlAbility("hide");for(var e=0;3>e;e++)for(var i=0;5>i;i++)if(this.abilityIndex=5*e+i,t.localX>158+80*i&&t.localX<217+80*i&&t.localY>120+70*e&&t.localY<180+70*e)return void this.ctrlAbility("showDetail")}},this),this.abilitySelectBox1=Tool.addBitmap(this.abilityContainer,"ability_selectBox_png",80*GameData.skill1Index+187,150,75,75,!1,!0),this.abilitySelectBox2=Tool.addBitmap(this.abilityContainer,"ability_selectBox_png",80*GameData.skill2Index+187,220,75,75,!1,!0),this.abilitySkill=Tool.addTextField(this.abilityContainer,120,60,0,0,18,16777215,"剩余技能点:"+GameData.skillNum),this.abilityBody=Tool.addTextField(this.abilityContainer,455,60,0,0,18,16777215,"剩余属性值:"+GameData.bodyNum);
for(var e=0,i=0,a=0;5>a;a++)e=Math.floor(GameData.skill1State[a]),i=Math.floor(100*(GameData.skill1State[a]-e)),this.abilityIcon.push(Tool.addBitmap(this.abilityContainer,this.abilityData.skill1[a].icon,80*a+187,150,60,60,!1,!0)),this.abilityText.push(Tool.addTextField(this.abilityContainer,80*a+163,162,50,15,15,16711680,e+"/"+i)),this.abilityText[a].textAlign=egret.HorizontalAlign.RIGHT;for(var a=0;5>a;a++)e=Math.floor(GameData.skill2State[a]),i=Math.floor(100*(GameData.skill2State[a]-e)),this.abilityIcon.push(Tool.addBitmap(this.abilityContainer,this.abilityData.skill2[a].icon,80*a+187,220,60,60,!1,!0)),this.abilityText.push(Tool.addTextField(this.abilityContainer,80*a+163,232,50,15,15,16711680,e+"/"+i)),this.abilityText[a+5].textAlign=egret.HorizontalAlign.RIGHT;for(var a=0;5>a;a++)e=Math.floor(GameData.abilityState[a]),i=Math.floor(100*(GameData.abilityState[a]-e)),this.abilityData.data[a].state=Math.floor(e/(i/5))+1,this.abilityData.data[a].state>5&&(this.abilityData.data[a].state=5),this.abilityIcon.push(Tool.addBitmap(this.abilityContainer,this.abilityData.data[a].icon+this.abilityData.data[a].state+"_png",80*a+187,290,60,60,!1,!0)),this.abilityText.push(Tool.addTextField(this.abilityContainer,80*a+163,302,50,15,15,16711680,e+"/"+i)),this.abilityText[a+10].textAlign=egret.HorizontalAlign.RIGHT;this.addChild(this.abilityContainer),this.abilityContainer.scaleX=0,this.abilityContainer.scaleY=0,this.abilityContainer.setChildIndex(this.abilitySelectBox1,99),this.abilityContainer.setChildIndex(this.abilitySelectBox2,99);var o=egret.Tween.get(this.abilityContainer);o.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if("empty"==this.showing)return;GameData.saveData();var o=egret.Tween.get(this.abilityContainer);o.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.abilityContainer=Tool.clearItem(this.abilityContainer),this.abilityDetailContainer=null,this.abilityDetailLevel=null,this.abilityBackground=null,this.abilityDetailIcon=null,this.abilitySelectBox1=null,this.abilitySelectBox2=null,this.abilityIsDetail=null,this.abilitySkill=null,this.abilityIndex=null,this.abilityBody=null,this.abilityText=null,this.abilityData=null,this.abilityIcon=null,this.showing="empty"},this)}else if("showDetail"==t){this.abilityIsDetail=!0,this.abilityDetailContainer=new egret.DisplayObjectContainer,this.abilityDetailContainer.width=300,this.abilityDetailContainer.height=180,this.abilityDetailContainer.anchorOffsetX=150,this.abilityDetailContainer.anchorOffsetY=90,this.abilityDetailContainer.x=this.abilityContainer.width/2,this.abilityDetailContainer.y=this.abilityContainer.height/2,this.abilityContainer.addChild(this.abilityDetailContainer);var n=Tool.addBitmap(this.abilityDetailContainer,"ability_detail_png",0,0,300,180);this.abilityState=Tool.addTextField(this.abilityDetailContainer,15,10,70,22,22,16711680,"携带中");var s=Tool.addTextField(this.abilityDetailContainer,120,60,150,90,15,16777215,"简介");if(this.abilityDetailLevel=Tool.addTextField(this.abilityDetailContainer,25,130,90,20,20,16777215,"Level:"+this.abilityText[this.abilityIndex].text.substr(0,this.abilityText[this.abilityIndex].text.length-3)),this.abilityIndex<5?s.text=this.abilityData.skill1[this.abilityIndex].intruction:this.abilityIndex<10?s.text=this.abilityData.skill2[this.abilityIndex-5].intruction:this.abilityIndex<15&&(s.text=this.abilityData.data[this.abilityIndex-10].intruction),s.textAlign=egret.HorizontalAlign.LEFT,this.abilityDetailIcon=new egret.Bitmap,this.abilityDetailIcon.texture=this.abilityIcon[this.abilityIndex].texture,this.abilityDetailContainer.addChild(this.abilityDetailIcon),this.abilityDetailIcon.width=50,this.abilityDetailIcon.height=50,this.abilityDetailIcon.x=40,this.abilityDetailIcon.y=65,this.abilityIndex>9)this.abilityState.text="属  性";else if(this.abilityIndex!=GameData.skill1Index&&this.abilityIndex!=GameData.skill2Index+5){var h=parseInt(this.abilityText[this.abilityIndex].text.substr(0,this.abilityText[this.abilityIndex].text.length-3));0==h?this.abilityState.text="未激活":this.abilityState.text="携  带"}n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){if(t.localX>40&&t.localX<90&&t.localY>70&&t.localY<114)this.ctrlAbility("levelUp");else if(t.localX>15&&t.localX<90&&t.localY>5&&t.localY<40){if(this.abilityIndex>9)return;if(0==parseInt(this.abilityText[this.abilityIndex].text.substr(0,this.abilityText[this.abilityIndex].text.length-3)))return;this.abilityIndex<5?(GameData.skill1Index=this.abilityIndex,this.abilitySelectBox1.x=this.abilityIcon[this.abilityIndex].x):this.abilityIndex<10&&(GameData.skill2Index=this.abilityIndex-5,this.abilitySelectBox2.x=this.abilityIcon[this.abilityIndex].x),this.ctrlAbility("hideDetail")}else t.localX>215&&t.localX<280&&t.localY>10&&t.localY<35&&this.ctrlAbility("hideDetail")},this),this.abilityDetailContainer.scaleX=0,this.abilityDetailContainer.scaleY=0;var o=egret.Tween.get(this.abilityDetailContainer);o.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hideDetail"==t){if(!this.abilityIsDetail)return;this.abilityIsDetail=!1;var o=egret.Tween.get(this.abilityDetailContainer);o.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.abilityDetailContainer=Tool.clearItem(this.abilityDetailContainer),this.abilityDetailLevel=null,this.abilityState=null,this.showing="ability"},this)}else if("levelUp"==t){var e=0,i=0;if("未激活"==this.abilityState.text&&(this.abilityState.text="携带"),this.abilityIndex<5)e=Math.floor(GameData.skill1State[this.abilityIndex]),i=Math.floor(100*(GameData.skill1State[this.abilityIndex]-e)),GameData.skillNum>0&&i>e&&(GameData.skillNum--,GameData.skill1State[this.abilityIndex]++,this.abilityText[this.abilityIndex].text=e+1+"/"+i);else if(this.abilityIndex<10)e=Math.floor(GameData.skill2State[this.abilityIndex-5]),i=Math.floor(100*(GameData.skill2State[this.abilityIndex-5]-e)),GameData.skillNum>0&&i>e&&(GameData.skillNum--,GameData.skill2State[this.abilityIndex-5]++,this.abilityText[this.abilityIndex].text=e+1+"/"+i);else if(this.abilityIndex<15){var a=this.abilityIndex-10;if(e=Math.floor(GameData.abilityState[a]),i=Math.floor(100*(GameData.abilityState[a]-e)),GameData.bodyNum>0&&i>e){GameData.bodyNum--,GameData.abilityState[a]++;var l=Math.floor(e/(i/5))+1;this.abilityIcon[this.abilityIndex].texture=RES.getRes(this.abilityData.data[a].icon+l+"_png"),this.abilityDetailIcon.texture=RES.getRes(this.abilityData.data[a].icon+l+"_png"),this.abilityText[this.abilityIndex].text=e+1+"/"+i}}this.abilityDetailLevel.text="Level:"+this.abilityText[this.abilityIndex].text.substr(0,this.abilityText[this.abilityIndex].text.length-3),this.abilityBody.text="剩余属性值:"+GameData.bodyNum,this.abilitySkill.text="剩余技能点:"+GameData.skillNum}},p.ctrlAhievement=function(t){if("show"==t){if("empty"!=this.showing)return;this.achievementData=achievement,this.showing="achievement",this.achievementBtn=[],this.achievementGift=[],this.achievementIcon=[],this.achievementItems=[],this.achievementDetail=[],this.achievementContainer=new egret.DisplayObjectContainer,this.achievementContainer.width=500,this.achievementContainer.height=350,this.achievementContainer.anchorOffsetX=this.achievementContainer.width/2,this.achievementContainer.anchorOffsetY=this.achievementContainer.height/2,this.achievementContainer.x=this.width/2,this.achievementContainer.y=this.height/2,this.achievementBackground=Tool.addBitmap(this.achievementContainer,"achievement_background_png",this.achievementContainer.width/2,this.achievementContainer.height/2,500,350,!1,!0),this.achievementBackground.touchEnabled=!0,this.achievementBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stageX>600&&t.stageX<630&&t.stageY>75&&t.stageY<100&&this.ctrlAhievement("hide")},this),this.achievementItemGroup=new eui.Group,this.achievementItemGroup.touchEnabled=!0,this.achievementItemGroup.width=470,this.achievementItemGroup.height=85*this.achievementData.items.length,this.achievementItemGroup.cacheAsBitmap=!0;for(var e=0;e<this.achievementData.items.length;e++)this.achievementItems.push(Tool.addBitmap(this.achievementItemGroup,"achievement_item_png",2,85*e,470,80)),this.achievementBtn.push(Tool.addBitmap(this.achievementItemGroup,"achievement_get_png",355,85*e+40,100,30)),this.achievementIcon.push(Tool.addBitmap(this.achievementItemGroup,this.achievementData.items[e].icon,13,85*e+15,50,50)),this.achievementGift.push(Tool.addTextField(this.achievementItemGroup,120,85*e+42,0,0,20,0,this.achievementData.items[e].gift)),this.achievementDetail.push(Tool.addTextField(this.achievementItemGroup,80,85*e+8,0,0,20,0,this.achievementData.items[e].detail)),this.achievementGift[e].textAlign=egret.HorizontalAlign.LEFT,this.achievementDetail[e].textAlign=egret.HorizontalAlign.LEFT;var i=new eui.Group,a=new eui.Scroller;a.viewport=i,a.touchEnabled=!0,a.width=470,a.height=260,a.x=17,a.y=70,this.achievementContainer.addChild(a),i.addChild(this.achievementItemGroup),this.addChild(this.achievementContainer),this.achievementContainer.scaleX=0,this.achievementContainer.scaleY=0;var o=egret.Tween.get(this.achievementContainer);o.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if("empty"==this.showing)return;var o=egret.Tween.get(this.achievementContainer);o.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.achievementContainer),this.achievementBackground=null,this.achievementContainer=null,this.achievementItemGroup=null,this.achievementDetail=null,this.achievementItems=null,this.achievementGift=null,this.achievementBtn=null,this.showing="empty"},this)}},p.ctrlDaily=function(t){if("show"==t){if("empty"!=this.showing)return;this.dailyData=daily,this.showing="daily",this.dailyBtn=[],this.dailyGift=[],this.dailyIcon=[],this.dailyItems=[],this.dailyDetail=[],this.dailyContainer=new egret.DisplayObjectContainer,this.dailyContainer.width=500,this.dailyContainer.height=350,this.dailyContainer.anchorOffsetX=this.dailyContainer.width/2,this.dailyContainer.anchorOffsetY=this.dailyContainer.height/2,this.dailyContainer.x=this.width/2,this.dailyContainer.y=this.height/2,this.dailyBackground=Tool.addBitmap(this.dailyContainer,"daily_background_png",this.dailyContainer.width/2,this.dailyContainer.height/2,500,350,!1,!0),this.dailyBackground.touchEnabled=!0,this.dailyBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){t.stageX>600&&t.stageX<630&&t.stageY>75&&t.stageY<100&&this.ctrlDaily("hide")},this),this.dailyItemGroup=new eui.Group,this.dailyItemGroup.touchEnabled=!0,this.dailyItemGroup.width=470,this.dailyItemGroup.height=85*this.dailyData.items.length,this.dailyItemGroup.cacheAsBitmap=!0;for(var e=0;e<this.dailyData.items.length;e++)this.dailyItems.push(Tool.addBitmap(this.dailyItemGroup,"daily_item_png",2,85*e,470,80)),this.dailyBtn.push(Tool.addBitmap(this.dailyItemGroup,"daily_get_png",355,85*e+40,100,30)),this.dailyIcon.push(Tool.addBitmap(this.dailyItemGroup,this.dailyData.items[e].icon,13,85*e+15,50,50)),this.dailyGift.push(Tool.addTextField(this.dailyItemGroup,120,85*e+42,0,0,20,0,this.dailyData.items[e].gift)),this.dailyDetail.push(Tool.addTextField(this.dailyItemGroup,80,85*e+8,0,0,20,0,this.dailyData.items[e].detail)),this.dailyGift[e].textAlign=egret.HorizontalAlign.LEFT,this.dailyDetail[e].textAlign=egret.HorizontalAlign.LEFT;var i=new eui.Group,a=new eui.Scroller;a.viewport=i,a.touchEnabled=!0,a.width=470,a.height=260,a.x=17,a.y=70,this.dailyContainer.addChild(a),i.addChild(this.dailyItemGroup),this.addChild(this.dailyContainer),this.dailyContainer.scaleX=0,this.dailyContainer.scaleY=0;var o=egret.Tween.get(this.dailyContainer);o.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else if("hide"==t){if("empty"==this.showing)return;var o=egret.Tween.get(this.dailyContainer);o.to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.removeChild(this.dailyContainer),this.dailyBackground=null,this.dailyContainer=null,this.dailyItemGroup=null,this.dailyDetail=null,this.dailyItems=null,this.dailyGift=null,this.dailyBtn=null,this.showing="empty"},this)}},p.syncFun=function(){this.isTop&&(this.bloodText.text="血量:"+Hero.getInstance().blood+" / "+Hero.getInstance().bloodMax,this.powerText.text="法力:"+Hero.getInstance().power+" / "+Hero.getInstance().powerMax,this.expText.text="经验:"+Hero.getInstance().exp+" / "+Hero.getInstance().expMax,this.bloodBar.width=Hero.getInstance().blood/Hero.getInstance().bloodMax*120,this.powerBar.width=Hero.getInstance().power/Hero.getInstance().powerMax*120,this.expBar.width=Hero.getInstance().exp/Hero.getInstance().expMax*120,this.level.text="LEVEL"+Hero.getInstance().level)},p.onTouchStart=function(t){t.stopImmediatePropagation(),this.isCtrl&&(t.target==this.left?Hero.getInstance().action("LeftDown"):t.target==this.right?Hero.getInstance().action("RightDown"):t.target==this.jump?Hero.getInstance().action("JumpDown"):t.target==this.attack?Hero.getInstance().action("AttackDown"):t.target==this.skill1?Hero.getInstance().action("SkillDown",GameData.skill1Index):t.target==this.skill2&&Hero.getInstance().action("SkillDown",GameData.skill2Index+5))},p.onTouchEnd=function(t){t.stopImmediatePropagation(),this.isCtrl&&(t.target==this.left?Hero.getInstance().action("stand"):t.target==this.right?Hero.getInstance().action("stand"):t.target==this.jump?Hero.getInstance().action("other"):t.target==this.attack?Hero.getInstance().action("stand"):t.target==this.skill1?Hero.getInstance().action("stand"):t.target==this.skill2&&Hero.getInstance().action("stand"))},p.onRemove=function(t){t.target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.target.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},e}(egret.DisplayObjectContainer);egret.registerClass(CtrlScene,"CtrlScene");var MapScene=function(t){function e(){t.call(this),this.itemList=[],this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){this.width=800,this.height=480,this.base=Tool.addBitmap(this,"worldMap_base_png",0,0,800,480,!0),this.map0=Tool.addBitmap(this,"worldMap_map0_disable_png",179,85),this.map1=Tool.addBitmap(this,"worldMap_map1_disable_png",183,165),this.map2=Tool.addBitmap(this,"worldMap_map2_disable_png",288,123),this.map3=Tool.addBitmap(this,"worldMap_map3_disable_png",553,4),this.map4=Tool.addBitmap(this,"worldMap_map4_disable_png",573,208),this.map5=Tool.addBitmap(this,"worldMap_map5_disable_png",343,321),this.map6=Tool.addBitmap(this,"worldMap_map6_disable_png",93,223),this.map7=Tool.addBitmap(this,"worldMap_map7_disable_png",9,325),this.map8=Tool.addBitmap(this,"worldMap_map8_disable_png",244,234),this.map9=Tool.addBitmap(this,"worldMap_map9_disable_png",292,404),this.back=Tool.addBitmap(this,"worldMap_back1_png",670,430,0,0,!0);for(var t=0;10>t;t++)this["map"+t].width=Math.floor(this["map"+t].measuredWidth*this.base.width/640),this["map"+t].height=Math.floor(this["map"+t].measuredHeight*this.base.height/470),GameData.MapState[t]>0&&(this["map"+t].texture=RES.getRes("worldMap_map"+t+"_png"),this["map"+t].visible=!1);this.select=Tool.addDisplayContainer(this,this.width/2,this.height/2,this.width,this.height,!0,!0),this.selectBox=Tool.addBitmap(this.select,"worldMap_box_png",this.width/2,this.height/2,0,0,!1,!0),this.commonBtn=Tool.addBitmap(this.select,"worldMap_common1_png",435,180),this.hardBtn=Tool.addBitmap(this.select,"worldMap_hard0_png",435,240),this.ruinsBtn=Tool.addBitmap(this.select,"worldMap_ruin0_png",435,300),this.mapName=Tool.addTextField(this.select,215,100,150,30,30,0,""),this.level=Tool.addTextField(this.select,438,135,150,20,20,0,""),this.mapName.stroke=.6,this.select.visible=!1,this.hardBtn.touchEnabled=!0,this.ruinsBtn.touchEnabled=!0,this.commonBtn.touchEnabled=!0,this.commonBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),this.commonBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.commonBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this.hardBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),this.hardBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.hardBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this.ruinsBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),this.ruinsBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.ruinsBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)},p.ctrlSelect=function(){if(!this.detailContainer)if(this.select.visible)egret.Tween.get(this.select).to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.select.visible=!1,GameData.difficulty>0?(UIManage.getInstance().hideMap(),UIManage.getInstance().showWarScene()):GameData.mapIndex=-1;for(var t=0;t<this.itemList.length;t++)Tool.clearItem(this.itemList[t]);this.itemList.length=0},this);else{GameData.difficulty=-1,this.select.visible=!0,GameData.MapState[GameData.mapIndex]>1?this.hardBtn.texture=RES.getRes("worldMap_hard1_png"):this.hardBtn.texture=RES.getRes("worldMap_hard0_png"),GameData.MapState[GameData.mapIndex]>2?this.ruinsBtn.texture=RES.getRes("worldMap_ruin1_png"):this.ruinsBtn.texture=RES.getRes("worldMap_ruin0_png"),egret.Tween.get(this.select).to({scaleX:1,scaleY:1},500,egret.Ease.backOut);var t=getMap(GameData.mapIndex);this.mapName.text=t.name,this.level.text="推荐等级:"+t.level;for(var e=0;e<t.dropItem.length;e++){var i=t.dropItem[e];this.itemList.push(Tool.addBitmap(this.select,"item_background"+i.grade+"_png",230+60*(e%3),230+55*Math.floor(e/3),45,45,!1,!0)),this.itemList.push(Tool.addBitmap(this.select,i.res,230+60*(e%3),230+55*Math.floor(e/3),30,30,!1,!0));var a=this.itemList[this.itemList.length-1];a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ctrlDetail.bind(this,i),this)}}},p.onTouchStart=function(t){return t.stopImmediatePropagation(),this.select.visible?void(t.target==this.commonBtn?this.commonBtn.texture=RES.getRes("worldMap_common2_png"):t.target==this.hardBtn&&GameData.MapState[GameData.mapIndex]>1?this.hardBtn.texture=RES.getRes("worldMap_hard2_png"):t.target==this.ruinsBtn&&GameData.MapState[GameData.mapIndex]>2&&(this.ruinsBtn.texture=RES.getRes("worldMap_ruin2_png"))):(t.target==this.back&&(this.back.texture=RES.getRes("worldMap_back2_png")),205<t.stageX&&t.stageX<273&&140<t.stageY&&t.stageY<170?GameData.mapIndex=0:195<t.stageX&&t.stageX<300&&210<t.stageY&&t.stageY<235?GameData.mapIndex=1:405<t.stageX&&t.stageX<505&&165<t.stageY&&t.stageY<190?GameData.mapIndex=2:650<t.stageX&&t.stageX<755&&125<t.stageY&&t.stageY<150?GameData.mapIndex=3:618<t.stageX&&t.stageX<720&&300<t.stageY&&t.stageY<325?GameData.mapIndex=4:425<t.stageX&&t.stageX<530&&385<t.stageY&&t.stageY<415?GameData.mapIndex=5:180<t.stageX&&t.stageX<285&&360<t.stageY&&t.stageY<390?GameData.mapIndex=6:45<t.stageX&&t.stageX<150&&420<t.stageY&&t.stageY<445?GameData.mapIndex=7:285<t.stageX&&t.stageX<390&&315<t.stageY&&t.stageY<340?GameData.mapIndex=8:305<t.stageX&&t.stageX<410&&412<t.stageY&&t.stageY<437&&(GameData.mapIndex=9),void(-1!=GameData.mapIndex&&GameData.MapState[GameData.mapIndex]>0&&(this["map"+GameData.mapIndex].visible=!0)))},p.onTouchEnd=function(t){return t.stopImmediatePropagation(),this.select.visible?void(t.target==this.commonBtn?(GameData.difficulty=1,this.commonBtn.texture=RES.getRes("worldMap_common1_png"),this.ctrlSelect()):t.target==this.hardBtn&&GameData.MapState[GameData.mapIndex]>1?(GameData.difficulty=2,this.hardBtn.texture=RES.getRes("worldMap_hard1_png"),this.ctrlSelect()):t.target==this.ruinsBtn&&GameData.MapState[GameData.mapIndex]>2?(GameData.difficulty=3,this.ruinsBtn.texture=RES.getRes("worldMap_ruin1_png"),this.ctrlSelect()):t.localX>585&&t.localX<610&&t.localY>70&&t.localY<95&&(GameData.difficulty=-1,this.ctrlSelect())):(t.target==this.back&&(this.back.texture=RES.getRes("worldMap_back1_png"),UIManage.getInstance().hideMap(),UIManage.getInstance().showWelcome()),void(-1!=GameData.mapIndex&&GameData.MapState[GameData.mapIndex]>0&&(this["map"+GameData.mapIndex].visible=!1,this.ctrlSelect())))},p.onRemove=function(t){t.target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.target.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},p.ctrlDetail=function(t){if(void 0===t&&(t=null),null==this.detailContainer){this.detailContainer=Tool.addDisplayContainer(this,GameData.gameWidth/2,GameData.gameHeight/2,500,250,!0,!0);var e=Tool.addBitmap(this.detailContainer,"worldMap_detail_png",0,0,500,250);e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ctrlDetail,this),Tool.addBitmap(this.detailContainer,t.res,90,95,70,70,!1,!0),Tool.addBitmap(this.detailContainer,"other_"+t.type+"_png",355,52,25,25,!1,!0),Tool.addTextField(this.detailContainer,160,40,0,0,25,0,t.name).stroke=1,Tool.addTextField(this.detailContainer,375,40,0,0,25,0,t.cost).stroke=.5,Tool.addTextField(this.detailContainer,160,82,300,60,20,0,t.info).textAlign=egret.HorizontalAlign.LEFT;var i=egret.Tween.get(this.detailContainer);i.to({scaleX:1,scaleY:1},500,egret.Ease.backOut)}else egret.Tween.get(this.detailContainer).to({scaleX:0,scaleY:0},500,egret.Ease.backIn).call(function(){this.detailContainer=Tool.clearItem(this.detailContainer)},this)},e}(egret.DisplayObjectContainer);egret.registerClass(MapScene,"MapScene");var WarScene=function(t){function e(){t.call(this),this.absoluteX=0,this.absoluteY=0,this.tureWidth=0,this.tureHeight=0,this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){P2Tool.initSpace(50,new egret.Rectangle(0,0,this.width,this.height)),this.width=GameData.gameWidth,this.height=GameData.gameHeight,this.mapData=getMap(GameData.mapIndex),this.background=Tool.addBitmap(this,this.mapData.res,0,0,0,0,!0),this.tureWidth=this.background.width,this.tureHeight=this.background.height;var t=P2Tool.createPlane(World.P2World,0,-555,0);t.shapes[0].collisionMask=3,this.role=new egret.DisplayObjectContainer,this.item=new egret.DisplayObjectContainer,this.addChild(this.role),this.addChild(this.item),this.role.addChild(Hero.getInstance()),this.y=-180;for(var e=0;10>e;e++)GameData.enemyArray.push(new Enemy("1",e/2*400+100)),this.role.addChild(GameData.enemyArray[e])},p.syncDisplay=function(){for(var t=0;t<GameData.enemyArray.length;t++){var e=GameData.enemyArray[t];if(e.isDie&&GameData.enemyArray.splice(t,1),GameData.enemyArray.length<10){var i=1e3*Math.random()+200,e=new Enemy("1",i);GameData.enemyArray.push(e),this.role.addChild(e)}}for(var t=0;t<GameData.bulletArray.length;t++){var a=GameData.bulletArray[t];a.isOver&&(null!=a.hitMC&&a.show.parent.removeChild(a.hitMC),a.show.parent.removeChild(a.show),GameData.bulletArray.splice(t,1))}for(var t=0;t<GameData.itemArray.length;t++){var o=GameData.itemArray[t];o.isOver&&(o.show.parent.removeChild(o.show),GameData.itemArray.splice(t,1))}Hero.getInstance().syncFun(),CtrlScene.getInstance().syncFun();for(var t=0;t<GameData.enemyArray.length;t++)GameData.enemyArray[t].syncFun();for(var t=0;t<GameData.bulletArray.length;t++)GameData.bulletArray[t].syncFun();for(var t=0;t<GameData.itemArray.length;t++)GameData.itemArray[t].syncFun()},p.onTouchStart=function(t){t.stopImmediatePropagation(),console.log("onTouchStart")},p.onTouchEnd=function(t){t.stopImmediatePropagation()},p.onRemove=function(t){t.target==this?(this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)):(t.target.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this))},p.control=function(t){"DownDown"==t||"LeftDown"==t||"RightDown"==t||"UpDown"==t?Hero.getInstance().action(t):"RightUp"==t||"LeftUp"==t||"UpUp"==t||"DownUp"==t||"AttackUp"==t||"Skill1Up"==t||"Skill2Up"==t||"GetUp"==t?Hero.getInstance().action("stand"):"JumpUp"==t?Hero.getInstance().action("other"):"JumpDown"==t?Hero.getInstance().action("JumpDown"):"AttackDown"==t?Hero.getInstance().action("AttackDown"):"Skill1Down"==t?Hero.getInstance().action("SkillDown",GameData.skill1Index):"Skill2Down"==t?Hero.getInstance().action("SkillDown",GameData.skill2Index+5):"GetDown"==t&&Hero.getInstance().action("GetDown")},e}(egret.DisplayObjectContainer);egret.registerClass(WarScene,"WarScene");var WelcomeScene=function(t){function e(){t.call(this),this.absoluteX=0,this.absoluteY=0,this.tureWidth=0,this.tureHeight=0,this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){P2Tool.initSpace(50,new egret.Rectangle(0,0,this.width,this.height)),this.width=GameData.gameWidth,this.height=GameData.gameHeight,this._name="欢迎页面",this.background=Tool.addBitmap(this,"map_welcome_png",0,0,0,0,!0),this.tureWidth=this.background.width,this.tureHeight=this.background.height;var t=P2Tool.createPlane(World.P2World,0,-555,0);t.shapes[0].collisionMask=3,this.showBody=[],this.addChild(Hero.getInstance()),this.y=-180},p.syncDisplay=function(){for(var t=0;t<this.showBody.length;t++)P2Tool.syncDisplay(this.showBody[t]);Hero.getInstance().syncFun()},p.onTouchStart=function(t){this.absoluteX=t.stageX-this.x,this.absoluteY=t.stageY-this.y,175<this.absoluteX&&this.absoluteX<245&&200<this.absoluteY&&this.absoluteY<280&&CtrlScene.getInstance().ctrlDaily("show"),315<this.absoluteX&&this.absoluteX<350&&190<this.absoluteY&&this.absoluteY<280&&CtrlScene.getInstance().ctrlAhievement("show"),480<this.absoluteX&&this.absoluteX<540&&135<this.absoluteY&&this.absoluteY<250&&CtrlScene.getInstance().ctrlAbility("show"),110<this.absoluteX&&this.absoluteX<175&&325<this.absoluteY&&this.absoluteY<395&&CtrlScene.getInstance().ctrlWeaponShop("show"),245<this.absoluteX&&this.absoluteX<305&&325<this.absoluteY&&this.absoluteY<395&&CtrlScene.getInstance().ctrlDrupShop("show"),165<this.absoluteX&&this.absoluteX<220&&470<this.absoluteY&&this.absoluteY<550&&CtrlScene.getInstance().ctrlData("show"),5<this.absoluteX&&this.absoluteX<100&&425<this.absoluteY&&this.absoluteY<550&&CtrlScene.getInstance().ctrlBag("show")},p.onTouchEnd=function(t){},p.onRemove=function(t){t.target==this?(this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)):(t.target.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchStart,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),t.target.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this))},p.control=function(t){"DownDown"==t||"LeftDown"==t||"RightDown"==t||"UpDown"==t?Hero.getInstance().action(t):"RightUp"==t||"LeftUp"==t||"UpUp"==t||"DownUp"==t||"AttackUp"==t||"SkillUp"==t||"GetUp"==t?Hero.getInstance().action("stand"):"JumpUp"==t?Hero.getInstance().action("other"):"JumpDown"==t&&Hero.getInstance().action("JumpDown")},e}(egret.DisplayObjectContainer);egret.registerClass(WelcomeScene,"WelcomeScene");